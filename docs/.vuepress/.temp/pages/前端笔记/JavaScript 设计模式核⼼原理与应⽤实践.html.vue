<template><div><h1 id="javascript-è®¾è®¡æ¨¡å¼æ ¸å¿ƒåŸç†ä¸åº”ç”¨å®è·µ" tabindex="-1"><a class="header-anchor" href="#javascript-è®¾è®¡æ¨¡å¼æ ¸å¿ƒåŸç†ä¸åº”ç”¨å®è·µ" aria-hidden="true">#</a> JavaScript è®¾è®¡æ¨¡å¼æ ¸â¼¼åŸç†ä¸åº”â½¤å®è·µ</h1>
<h2 id="è®¾è®¡åŸåˆ™" tabindex="-1"><a class="header-anchor" href="#è®¾è®¡åŸåˆ™" aria-hidden="true">#</a> è®¾è®¡åŸåˆ™</h2>
<p>SOLID</p>
<ul>
<li>å•ä¸€åŠŸèƒ½åŸåˆ™ï¼ˆSingle Responsibility Principleï¼‰</li>
<li>å¼€æ”¾å°é—­åŸåˆ™ï¼ˆOpened Closed Principleï¼‰</li>
<li>é‡Œå¼æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰</li>
<li>æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼‰</li>
<li>ä¾èµ–åè½¬åŸåˆ™ï¼ˆDependency Inversion Principleï¼‰</li>
</ul>
<h3 id="æ ¸å¿ƒæ€æƒ³â€”â€”å°è£…å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒæ€æƒ³â€”â€”å°è£…å˜åŒ–" aria-hidden="true">#</a> æ ¸å¿ƒæ€æƒ³â€”â€”å°è£…å˜åŒ–</h3>
<p>è®¾è®¡æ¨¡å¼å‡ºç°çš„èƒŒæ™¯ï¼Œæ˜¯è½¯ä»¶è®¾è®¡çš„å¤æ‚åº¦æ—¥ç›Šé£™å‡ã€‚è½¯ä»¶è®¾è®¡è¶Šæ¥è¶Šå¤æ‚çš„â€œç½ªé­ç¥¸é¦–â€ï¼Œå°±æ˜¯<strong>å˜åŒ–</strong>ã€‚</p>
<p>ä½†åœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸å‘ç”Ÿå˜åŒ–çš„ä»£ç å¯ä»¥è¯´æ˜¯ä¸å­˜åœ¨çš„ã€‚æˆ‘ä»¬èƒ½åšçš„åªæœ‰å°†è¿™ä¸ªå˜åŒ–é€ æˆçš„å½±å“<strong>æœ€å°åŒ–</strong> â€”â€” <strong>å°†å˜ä¸ä¸å˜åˆ†ç¦»ï¼Œç¡®ä¿å˜åŒ–çš„éƒ¨åˆ†çµæ´»ã€ä¸å˜çš„éƒ¨åˆ†ç¨³å®š</strong>ã€‚
è¿™ä¸ªè¿‡ç¨‹ï¼Œå°±å«â€œå°è£…å˜åŒ–â€ï¼›è¿™æ ·çš„ä»£ç ï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€è°“çš„â€œå¥å£®â€çš„ä»£ç ï¼Œå®ƒå¯ä»¥ç»å¾—èµ·å˜åŒ–çš„è€ƒéªŒã€‚è€Œè®¾è®¡æ¨¡å¼å‡ºç°çš„æ„ä¹‰ï¼Œå°±æ˜¯å¸®æˆ‘ä»¬å†™å‡ºè¿™æ ·çš„ä»£ç ã€‚</p>
<h3 id="è®¾è®¡æ¨¡å¼çš„æœ¯" tabindex="-1"><a class="header-anchor" href="#è®¾è®¡æ¨¡å¼çš„æœ¯" aria-hidden="true">#</a> è®¾è®¡æ¨¡å¼çš„æœ¯</h3>
<p><img src="https://blog-picgo-typora.oss-cn-hangzhou.aliyuncs.com/image-20220805093228638.png" alt="image-20220805093228638"></p>
<p>è®¾è®¡æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³ï¼Œå°±æ˜¯â€œå°è£…å˜åŒ–â€ã€‚ç¡®å®å¦‚æ­¤ï¼Œæ— è®ºæ˜¯åˆ›å»ºå‹ã€ç»“æ„å‹è¿˜æ˜¯è¡Œä¸ºå‹ï¼Œè¿™äº›å…·ä½“çš„è®¾è®¡æ¨¡å¼éƒ½æ˜¯åœ¨ç”¨è‡ªå·±çš„æ–¹å¼å»å°è£…ä¸åŒç±»å‹çš„å˜åŒ– â€”â€” åˆ›å»ºå‹æ¨¡å¼å°è£…äº†åˆ›å»ºå¯¹è±¡è¿‡ç¨‹ä¸­çš„å˜åŒ–ï¼Œæ¯”å¦‚ä¸‹èŠ‚çš„å·¥å‚æ¨¡å¼ï¼Œå®ƒåšçš„äº‹æƒ…å°±æ˜¯å°†åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹æŠ½ç¦»ï¼›ç»“æ„å‹æ¨¡å¼å°è£…çš„æ˜¯å¯¹è±¡ä¹‹é—´ç»„åˆæ–¹å¼çš„å˜åŒ–ï¼Œç›®çš„åœ¨äºçµæ´»åœ°è¡¨è¾¾å¯¹è±¡é—´çš„é…åˆä¸ä¾èµ–å…³ç³»ï¼›è€Œè¡Œä¸ºå‹æ¨¡å¼åˆ™å°†æ˜¯å¯¹è±¡åƒå˜ä¸‡åŒ–çš„è¡Œä¸ºè¿›è¡ŒæŠ½ç¦»ï¼Œç¡®ä¿æˆ‘ä»¬èƒ½å¤Ÿæ›´å®‰å…¨ã€æ›´æ–¹ä¾¿åœ°å¯¹è¡Œä¸ºè¿›è¡Œæ›´æ”¹ã€‚
å°è£…å˜åŒ–ï¼Œå°è£…çš„æ­£æ˜¯è½¯ä»¶ä¸­é‚£äº›ä¸ç¨³å®šçš„è¦ç´ ï¼Œå®ƒæ˜¯ä¸€ç§é˜²æ‚£äºæœªç„¶çš„è¡Œä¸º â€”â€” æå‰æŠ½ç¦»äº†å˜åŒ–ï¼Œå°±ä¸ºåç»­çš„æ‹“å±•æä¾›äº†æ— é™çš„å¯èƒ½æ€§ï¼Œå¦‚æ­¤ï¼Œæˆ‘ä»¬æ‰èƒ½åšåˆ°åœ¨å˜åŒ–åˆ°æ¥çš„æ—¶å€™ä»å®¹ä¸è¿«ã€‚</p>
<h2 id="å·¥å‚æ¨¡å¼-åˆ›å»ºå‹" tabindex="-1"><a class="header-anchor" href="#å·¥å‚æ¨¡å¼-åˆ›å»ºå‹" aria-hidden="true">#</a> å·¥å‚æ¨¡å¼ï¼ˆåˆ›å»ºå‹ï¼‰</h2>
<h2 id="å·¥å‚æ¨¡å¼Â·ç®€å•å·¥å‚" tabindex="-1"><a class="header-anchor" href="#å·¥å‚æ¨¡å¼Â·ç®€å•å·¥å‚" aria-hidden="true">#</a> å·¥å‚æ¨¡å¼Â·ç®€å•å·¥å‚</h2>
<p>åŒºåˆ†â€œå˜ä¸ä¸å˜â€</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token parameter">name <span class="token punctuation">,</span> age<span class="token punctuation">,</span> career<span class="token punctuation">,</span> work</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
    <span class="token keyword">this</span><span class="token punctuation">.</span>career <span class="token operator">=</span> career
    <span class="token keyword">this</span><span class="token punctuation">.</span>work <span class="token operator">=</span> work
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Factory</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> work
    <span class="token keyword">switch</span><span class="token punctuation">(</span>career<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'coder'</span><span class="token operator">:</span>
            work <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token string">'å†™ä»£ç '</span><span class="token punctuation">,</span><span class="token string">'å†™ç³»åˆ†'</span><span class="token punctuation">,</span> <span class="token string">'ä¿®Bug'</span><span class="token punctuation">]</span>
            <span class="token keyword">break</span>
        <span class="token keyword">case</span> <span class="token string">'product manager'</span><span class="token operator">:</span>
            work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'è®¢ä¼šè®®å®¤'</span><span class="token punctuation">,</span> <span class="token string">'å†™PRD'</span><span class="token punctuation">,</span> <span class="token string">'å‚¬æ›´'</span><span class="token punctuation">]</span>
            <span class="token keyword">break</span>
        <span class="token keyword">case</span> <span class="token string">'boss'</span><span class="token operator">:</span>
            work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'å–èŒ¶'</span><span class="token punctuation">,</span> <span class="token string">'çœ‹æŠ¥'</span><span class="token punctuation">,</span> <span class="token string">'è§å®¢æˆ·'</span><span class="token punctuation">]</span>
        <span class="token keyword">case</span> <span class="token string">'xxx'</span><span class="token operator">:</span>
            <span class="token comment">// å…¶å®ƒå·¥ç§çš„èŒè´£åˆ†é…</span>
            <span class="token operator">...</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career<span class="token punctuation">,</span> work<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å·¥å‚æ¨¡å¼Â·æŠ½è±¡å·¥å‚" tabindex="-1"><a class="header-anchor" href="#å·¥å‚æ¨¡å¼Â·æŠ½è±¡å·¥å‚" aria-hidden="true">#</a> å·¥å‚æ¨¡å¼Â·æŠ½è±¡å·¥å‚</h2>
<p>ç†è§£â€œå¼€æ”¾å°é—­â€</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MobilePhoneFactory</span> <span class="token punctuation">{</span>
  <span class="token comment">// æä¾›æ“ä½œç³»ç»Ÿçš„æ¥å£</span>
  <span class="token function">createOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"æŠ½è±¡å·¥å‚æ–¹æ³•ä¸å…è®¸ç›´æ¥è°ƒç”¨ï¼Œä½ éœ€è¦å°†æˆ‘é‡å†™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// æä¾›ç¡¬ä»¶çš„æ¥å£</span>
  <span class="token function">createHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"æŠ½è±¡å·¥å‚æ–¹æ³•ä¸å…è®¸ç›´æ¥è°ƒç”¨ï¼Œä½ éœ€è¦å°†æˆ‘é‡å†™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å…·ä½“å·¥å‚ç»§æ‰¿è‡ªæŠ½è±¡å·¥å‚</span>
<span class="token keyword">class</span> <span class="token class-name">FakeStarFactory</span> <span class="token keyword">extends</span> <span class="token class-name">MobilePhoneFactory</span> <span class="token punctuation">{</span>
  <span class="token function">createOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æä¾›å®‰å“ç³»ç»Ÿå®ä¾‹</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AndroidOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">createHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æä¾›é«˜é€šç¡¬ä»¶å®ä¾‹</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">QualcommHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®šä¹‰æ“ä½œç³»ç»Ÿè¿™ç±»äº§å“çš„æŠ½è±¡äº§å“ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">OS</span> <span class="token punctuation">{</span>
  <span class="token function">controlHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"æŠ½è±¡äº§å“æ–¹æ³•ä¸å…è®¸ç›´æ¥è°ƒç”¨ï¼Œä½ éœ€è¦å°†æˆ‘é‡å†™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®šä¹‰å…·ä½“æ“ä½œç³»ç»Ÿçš„å…·ä½“äº§å“ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">AndroidOS</span> <span class="token keyword">extends</span> <span class="token class-name">OS</span> <span class="token punctuation">{</span>
  <span class="token function">controlHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆ‘ä¼šç”¨å®‰å“çš„æ–¹å¼å»æ“ä½œç¡¬ä»¶"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AppleOS</span> <span class="token keyword">extends</span> <span class="token class-name">OS</span> <span class="token punctuation">{</span>
  <span class="token function">controlHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆ‘ä¼šç”¨ğŸçš„æ–¹å¼å»æ“ä½œç¡¬ä»¶"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®šä¹‰æ‰‹æœºç¡¬ä»¶è¿™ç±»äº§å“çš„æŠ½è±¡äº§å“ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">HardWare</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ‰‹æœºç¡¬ä»¶çš„å…±æ€§æ–¹æ³•ï¼Œè¿™é‡Œæå–äº†â€œæ ¹æ®å‘½ä»¤è¿è½¬â€è¿™ä¸ªå…±æ€§</span>
  <span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"æŠ½è±¡äº§å“æ–¹æ³•ä¸å…è®¸ç›´æ¥è°ƒç”¨ï¼Œä½ éœ€è¦å°†æˆ‘é‡å†™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®šä¹‰å…·ä½“ç¡¬ä»¶çš„å…·ä½“äº§å“ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">QualcommHardWare</span> <span class="token keyword">extends</span> <span class="token class-name">HardWare</span> <span class="token punctuation">{</span>
  <span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆ‘ä¼šç”¨é«˜é€šçš„æ–¹å¼å»è¿è½¬"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MiWare</span> <span class="token keyword">extends</span> <span class="token class-name">HardWare</span> <span class="token punctuation">{</span>
  <span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆ‘ä¼šç”¨å°ç±³çš„æ–¹å¼å»è¿è½¬"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// è¿™æ˜¯æˆ‘çš„æ‰‹æœº</span>
<span class="token keyword">const</span> myPhone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FakeStarFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// è®©å®ƒæ‹¥æœ‰æ“ä½œç³»ç»Ÿ</span>
<span class="token keyword">const</span> myOS <span class="token operator">=</span> myPhone<span class="token punctuation">.</span><span class="token function">createOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// è®©å®ƒæ‹¥æœ‰ç¡¬ä»¶</span>
<span class="token keyword">const</span> myHardWare <span class="token operator">=</span> myPhone<span class="token punctuation">.</span><span class="token function">createHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å¯åŠ¨æ“ä½œç³»ç»Ÿ(è¾“å‡ºâ€˜æˆ‘ä¼šç”¨å®‰å“çš„æ–¹å¼å»æ“ä½œç¡¬ä»¶â€™)</span>
myOS<span class="token punctuation">.</span><span class="token function">controlHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å”¤é†’ç¡¬ä»¶(è¾“å‡ºâ€˜æˆ‘ä¼šç”¨é«˜é€šçš„æ–¹å¼å»è¿è½¬â€™)</span>
myHardWare<span class="token punctuation">.</span><span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡å¦‚æœ‰ä¸€å¤©ï¼ŒFakeStar è¿‡æ°”äº†ï¼Œæˆ‘ä»¬éœ€è¦äº§å‡ºä¸€æ¬¾æ–°æœºæŠ•å…¥å¸‚åœºï¼Œè¿™æ—¶å€™æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬æ˜¯ä¸æ˜¯<strong>ä¸éœ€è¦å¯¹æŠ½è±¡å·¥å‚ MobilePhoneFactory åšä»»ä½•ä¿®æ”¹</strong>ï¼Œåªéœ€è¦æ‹“å±•å®ƒçš„ç§ç±»ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">newStarFactory</span> <span class="token keyword">extends</span> <span class="token class-name">MobilePhoneFactory</span> <span class="token punctuation">{</span>
  <span class="token function">createOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ“ä½œç³»ç»Ÿå®ç°ä»£ç </span>
  <span class="token punctuation">}</span>
  <span class="token function">createHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç¡¬ä»¶å®ç°ä»£ç </span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="å•ä¾‹æ¨¡å¼-åˆ›å»ºå‹" tabindex="-1"><a class="header-anchor" href="#å•ä¾‹æ¨¡å¼-åˆ›å»ºå‹" aria-hidden="true">#</a> å•ä¾‹æ¨¡å¼ï¼ˆåˆ›å»ºå‹ï¼‰</h1>
<p>Vuex çš„æ•°æ®ç®¡ç†å“²å­¦</p>
<p><strong>ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹</strong>ï¼Œè¿™æ ·çš„æ¨¡å¼å°±å«åšå•ä¾‹æ¨¡å¼ã€‚</p>
<h2 id="es6-ç‰ˆ" tabindex="-1"><a class="header-anchor" href="#es6-ç‰ˆ" aria-hidden="true">#</a> ES6 ç‰ˆ</h2>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">SingleDog</span> <span class="token punctuation">{</span>
  <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆ‘æ˜¯ä¸€ä¸ªå•ä¾‹å¯¹è±¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ¤æ–­æ˜¯å¦å·²ç»newè¿‡1ä¸ªå®ä¾‹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>SingleDog<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è‹¥è¿™ä¸ªå”¯ä¸€çš„å®ä¾‹ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå…ˆåˆ›å»ºå®ƒ</span>
      SingleDog<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¦‚æœè¿™ä¸ªå”¯ä¸€çš„å®ä¾‹å·²ç»å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›</span>
    <span class="token keyword">return</span> SingleDog<span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> s1 <span class="token operator">=</span> SingleDog<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> s2 <span class="token operator">=</span> SingleDog<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// true</span>
s1 <span class="token operator">===</span> s2<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="é—­åŒ…ç‰ˆ" tabindex="-1"><a class="header-anchor" href="#é—­åŒ…ç‰ˆ" aria-hidden="true">#</a> é—­åŒ…ç‰ˆ</h2>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">SingleDog</span> <span class="token punctuation">{</span>
  <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆ‘æ˜¯ä¸€ä¸ªå•ä¾‹å¯¹è±¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ¤æ–­æ˜¯å¦å·²ç»newè¿‡1ä¸ªå®ä¾‹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>SingleDog<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è‹¥è¿™ä¸ªå”¯ä¸€çš„å®ä¾‹ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå…ˆåˆ›å»ºå®ƒ</span>
      SingleDog<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¦‚æœè¿™ä¸ªå”¯ä¸€çš„å®ä¾‹å·²ç»å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›</span>
    <span class="token keyword">return</span> SingleDog<span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> s1 <span class="token operator">=</span> SingleDog<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> s2 <span class="token operator">=</span> SingleDog<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// true</span>
s1 <span class="token operator">===</span> s2<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="vuex-å¦‚ä½•ç¡®ä¿-store-çš„å”¯ä¸€æ€§" tabindex="-1"><a class="header-anchor" href="#vuex-å¦‚ä½•ç¡®ä¿-store-çš„å”¯ä¸€æ€§" aria-hidden="true">#</a> Vuex å¦‚ä½•ç¡®ä¿ Store çš„å”¯ä¸€æ€§</h2>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// å®‰è£…vuexæ’ä»¶</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å°†storeæ³¨å…¥åˆ°Vueå®ä¾‹ä¸­</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>
  store<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è°ƒç”¨ Vue.use()æ–¹æ³•ï¼Œæˆ‘ä»¬å®‰è£…äº† Vuex æ’ä»¶ã€‚Vuex æ’ä»¶æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåœ¨å†…éƒ¨å®ç°äº†ä¸€ä¸ª install æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨æ’ä»¶å®‰è£…æ—¶è¢«è°ƒç”¨ï¼Œä»è€ŒæŠŠ Store æ³¨å…¥åˆ° Vue å®ä¾‹é‡Œå»ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯ install ä¸€æ¬¡ï¼Œéƒ½ä¼šå°è¯•ç»™ Vue å®ä¾‹æ³¨å…¥ä¸€ä¸ª Storeã€‚
åœ¨ install æ–¹æ³•é‡Œï¼Œæœ‰ä¸€æ®µé€»è¾‘å’Œæˆ‘ä»¬æ¥¼ä¸Šçš„ getInstance éå¸¸ç›¸ä¼¼çš„é€»è¾‘ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">let</span> Vue <span class="token comment">// è¿™ä¸ªVueçš„ä½œç”¨å’Œæ¥¼ä¸Šçš„instanceä½œç”¨ä¸€æ ·</span>
<span class="token operator">...</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">install</span> <span class="token punctuation">(</span><span class="token parameter">_Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// åˆ¤æ–­ä¼ å…¥çš„Vueå®ä¾‹å¯¹è±¡æ˜¯å¦å·²ç»è¢«installè¿‡Vuexæ’ä»¶ï¼ˆæ˜¯å¦æœ‰äº†å”¯ä¸€çš„stateï¼‰</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Vue <span class="token operator">&amp;&amp;</span> _Vue <span class="token operator">===</span> Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>
        <span class="token string">'[vuex] already installed. Vue.use(Vuex) should be called only once.'</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// è‹¥æ²¡æœ‰ï¼Œåˆ™ä¸ºè¿™ä¸ªVueå®ä¾‹å¯¹è±¡installä¸€ä¸ªå”¯ä¸€çš„Vuex</span>
  Vue <span class="token operator">=</span> _Vue
  <span class="token comment">// å°†Vuexçš„åˆå§‹åŒ–é€»è¾‘å†™è¿›Vueçš„é’©å­å‡½æ•°é‡Œ</span>
  <span class="token function">applyMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="é¢è¯•çœŸé¢˜" tabindex="-1"><a class="header-anchor" href="#é¢è¯•çœŸé¢˜" aria-hidden="true">#</a> é¢è¯•çœŸé¢˜</h2>
<h3 id="å®ç°ä¸€ä¸ª-storage" tabindex="-1"><a class="header-anchor" href="#å®ç°ä¸€ä¸ª-storage" aria-hidden="true">#</a> å®ç°ä¸€ä¸ª Storage</h3>
<h4 id="" tabindex="-1"><a class="header-anchor" href="#" aria-hidden="true">#</a> </h4>
<p>æè¿°</p>
<blockquote>
<h4 id="å®ç°-storage-ä½¿å¾—è¯¥å¯¹è±¡ä¸ºå•ä¾‹-åŸºäº-localstorage-è¿›è¡Œå°è£…ã€‚å®ç°æ–¹æ³•-setitem-key-value-å’Œ-getitem-key-ã€‚" tabindex="-1"><a class="header-anchor" href="#å®ç°-storage-ä½¿å¾—è¯¥å¯¹è±¡ä¸ºå•ä¾‹-åŸºäº-localstorage-è¿›è¡Œå°è£…ã€‚å®ç°æ–¹æ³•-setitem-key-value-å’Œ-getitem-key-ã€‚" aria-hidden="true">#</a> å®ç° Storageï¼Œä½¿å¾—è¯¥å¯¹è±¡ä¸ºå•ä¾‹ï¼ŒåŸºäº localStorage è¿›è¡Œå°è£…ã€‚å®ç°æ–¹æ³• setItem(key,value) å’Œ getItem(key)ã€‚</h4>
</blockquote>
<h4 id="é™æ€æ–¹æ³•ç‰ˆæœ¬" tabindex="-1"><a class="header-anchor" href="#é™æ€æ–¹æ³•ç‰ˆæœ¬" aria-hidden="true">#</a> é™æ€æ–¹æ³•ç‰ˆæœ¬</h4>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// å®šä¹‰Storage</span>
<span class="token keyword">class</span> <span class="token class-name">Storage</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ¤æ–­æ˜¯å¦å·²ç»newè¿‡1ä¸ªå®ä¾‹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Storage<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è‹¥è¿™ä¸ªå”¯ä¸€çš„å®ä¾‹ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå…ˆåˆ›å»ºå®ƒ</span>
      Storage<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¦‚æœè¿™ä¸ªå”¯ä¸€çš„å®ä¾‹å·²ç»å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›</span>
    <span class="token keyword">return</span> Storage<span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">getItem</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">setItem</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> storage1 <span class="token operator">=</span> Storage<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> storage2 <span class="token operator">=</span> Storage<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

storage1<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"æé›·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æé›·</span>
storage1<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ä¹Ÿæ˜¯æé›·</span>
storage2<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è¿”å›true</span>
storage1 <span class="token operator">===</span> storage2<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é—­åŒ…ç‰ˆ-1" tabindex="-1"><a class="header-anchor" href="#é—­åŒ…ç‰ˆ-1" aria-hidden="true">#</a> é—­åŒ…ç‰ˆ</h4>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// å…ˆå®ç°ä¸€ä¸ªåŸºç¡€çš„StorageBaseç±»ï¼ŒæŠŠgetItemå’ŒsetItemæ–¹æ³•æ”¾åœ¨å®ƒçš„åŸå‹é“¾ä¸Š</span>
<span class="token keyword">function</span> <span class="token function">StorageBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">StorageBase</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getItem</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">StorageBase</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setItem</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ä»¥é—­åŒ…çš„å½¢å¼åˆ›å»ºä¸€ä¸ªå¼•ç”¨è‡ªç”±å˜é‡çš„æ„é€ å‡½æ•°</span>
<span class="token keyword">const</span> Storage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ¤æ–­è‡ªç”±å˜é‡æ˜¯å¦ä¸ºnull</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœä¸ºnullåˆ™newå‡ºå”¯ä¸€å®ä¾‹</span>
      instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StorageBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è¿™é‡Œå…¶å®ä¸ç”¨ new Storage çš„å½¢å¼è°ƒç”¨ï¼Œç›´æ¥ Storage() ä¹Ÿä¼šæœ‰ä¸€æ ·çš„æ•ˆæœ</span>
<span class="token keyword">const</span> storage1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> storage2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

storage1<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"æé›·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æé›·</span>
storage1<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ä¹Ÿæ˜¯æé›·</span>
storage2<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è¿”å›true</span>
storage1 <span class="token operator">===</span> storage2<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°ä¸€ä¸ªå…¨å±€çš„æ¨¡æ€æ¡†" tabindex="-1"><a class="header-anchor" href="#å®ç°ä¸€ä¸ªå…¨å±€çš„æ¨¡æ€æ¡†" aria-hidden="true">#</a> å®ç°ä¸€ä¸ªå…¨å±€çš„æ¨¡æ€æ¡†</h2>
<h4 id="æè¿°" tabindex="-1"><a class="header-anchor" href="#æè¿°" aria-hidden="true">#</a> æè¿°</h4>
<blockquote>
<h4 id="å®ç°ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„-modal-å¼¹æ¡†" tabindex="-1"><a class="header-anchor" href="#å®ç°ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„-modal-å¼¹æ¡†" aria-hidden="true">#</a> å®ç°ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ Modal å¼¹æ¡†</h4>
</blockquote>
<h4 id="-1" tabindex="-1"><a class="header-anchor" href="#-1" aria-hidden="true">#</a> </h4>
<h4 id="å®ç°" tabindex="-1"><a class="header-anchor" href="#å®ç°" aria-hidden="true">#</a> å®ç°</h4>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>å•ä¾‹æ¨¡å¼å¼¹æ¡†<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>style<span class="token operator">></span>
    #modal <span class="token punctuation">{</span>
        <span class="token literal-property property">height</span><span class="token operator">:</span> 200px<span class="token punctuation">;</span>
        <span class="token literal-property property">width</span><span class="token operator">:</span> 200px<span class="token punctuation">;</span>
        line<span class="token operator">-</span>height<span class="token operator">:</span> 200px<span class="token punctuation">;</span>
        <span class="token literal-property property">position</span><span class="token operator">:</span> fixed<span class="token punctuation">;</span>
        <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
        <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
        <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token literal-property property">border</span><span class="token operator">:</span> 1px solid black<span class="token punctuation">;</span>
        text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
	<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">'open'</span><span class="token operator">></span>æ‰“å¼€å¼¹æ¡†<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>
	<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">'close'</span><span class="token operator">></span>å…³é—­å¼¹æ¡†<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token comment">// æ ¸å¿ƒé€»è¾‘ï¼Œè¿™é‡Œé‡‡ç”¨äº†é—­åŒ…æ€è·¯æ¥å®ç°å•ä¾‹æ¨¡å¼</span>
    <span class="token keyword">const</span> Modal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">let</span> modal <span class="token operator">=</span> <span class="token keyword">null</span>
    	<span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>modal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            	modal <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
            	modal<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'æˆ‘æ˜¯ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„Modal'</span>
            	modal<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">'modal'</span>
            	modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
            	document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>modal<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> modal
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// ç‚¹å‡»æ‰“å¼€æŒ‰é’®å±•ç¤ºæ¨¡æ€æ¡†</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æœªç‚¹å‡»åˆ™ä¸åˆ›å»ºmodalå®ä¾‹ï¼Œé¿å…ä¸å¿…è¦çš„å†…å­˜å ç”¨;æ­¤å¤„ä¸ç”¨ new Modal çš„å½¢å¼è°ƒç”¨ä¹Ÿå¯ä»¥ï¼Œå’Œ Storage åŒç†</span>
    	<span class="token keyword">const</span> modal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    	modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// ç‚¹å‡»å…³é—­æŒ‰é’®éšè—æ¨¡æ€æ¡†</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">const</span> modal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>modal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	    modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="åŸå‹è®¾è®¡æ¨¡å¼-åˆ›å»ºå‹" tabindex="-1"><a class="header-anchor" href="#åŸå‹è®¾è®¡æ¨¡å¼-åˆ›å»ºå‹" aria-hidden="true">#</a> åŸå‹è®¾è®¡æ¨¡å¼ï¼ˆåˆ›å»ºå‹ï¼‰</h1>
<p>è°ˆ Prototype æ— å°äº‹</p>
<h3 id="åŸå‹" tabindex="-1"><a class="header-anchor" href="#åŸå‹" aria-hidden="true">#</a> åŸå‹</h3>
<p>åœ¨ JavaScript ä¸­ï¼Œæ¯ä¸ªæ„é€ å‡½æ•°éƒ½æ‹¥æœ‰ä¸€ä¸ª prototype å±æ€§ï¼Œå®ƒæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡ä¸­æœ‰ä¸€ä¸ª constructor å±æ€§æŒ‡å›æ„é€ å‡½æ•°ï¼›æ¯ä¸ªå®ä¾‹éƒ½æœ‰ä¸€ä¸ª<strong>proto</strong>å±æ€§ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æ„é€ å‡½æ•°å»åˆ›å»ºå®ä¾‹æ—¶ï¼Œå®ä¾‹çš„<strong>proto</strong>å±æ€§å°±ä¼šæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// åˆ›å»ºä¸€ä¸ªDogæ„é€ å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"è‚‰éª¨å¤´çœŸå¥½åƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// ä½¿ç”¨Dogæ„é€ å‡½æ•°åˆ›å»ºdogå®ä¾‹</span>
<span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">"æ—ºè´¢"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç é‡Œçš„å‡ ä¸ªå®ä½“ä¹‹é—´å°±å­˜åœ¨ç€è¿™æ ·çš„å…³ç³»ï¼š</p>
<p><img src="https://blog-picgo-typora.oss-cn-hangzhou.aliyuncs.com/image-20220805093835167.png" alt="image-20220805093835167"></p>
<h3 id="åŸå‹é“¾" tabindex="-1"><a class="header-anchor" href="#åŸå‹é“¾" aria-hidden="true">#</a> åŸå‹é“¾</h3>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// è¾“å‡º"è‚‰éª¨å¤´çœŸå¥½åƒ"</span>
dog<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// è¾“å‡º"[object Object]"</span>
dog<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ˜æ˜æ²¡æœ‰åœ¨ dog å®ä¾‹é‡Œæ‰‹åŠ¨å®šä¹‰ eat æ–¹æ³•å’Œ toString æ–¹æ³•ï¼Œå®ƒä»¬è¿˜æ˜¯è¢«æˆåŠŸåœ°è°ƒç”¨äº†ã€‚è¿™æ˜¯å› ä¸ºå½“æˆ‘è¯•å›¾è®¿é—®ä¸€ä¸ª JavaScript å®ä¾‹çš„å±æ€§/æ–¹æ³•æ—¶ï¼Œå®ƒé¦–å…ˆæœç´¢è¿™ä¸ªå®ä¾‹æœ¬èº«ï¼›å½“å‘ç°å®ä¾‹æ²¡æœ‰å®šä¹‰å¯¹åº”çš„å±æ€§/æ–¹æ³•æ—¶ï¼Œå®ƒä¼šè½¬è€Œå»æœç´¢å®ä¾‹çš„åŸå‹å¯¹è±¡ï¼›å¦‚æœåŸå‹å¯¹è±¡ä¸­ä¹Ÿæœç´¢ä¸åˆ°ï¼Œå®ƒå°±å»æœç´¢åŸå‹å¯¹è±¡çš„åŸå‹å¯¹è±¡ï¼Œè¿™ä¸ªæœç´¢çš„è½¨è¿¹ï¼Œå°±å«åšåŸå‹é“¾ã€‚
ä»¥æˆ‘ä»¬çš„ eat æ–¹æ³•å’Œ toString æ–¹æ³•çš„è°ƒç”¨è¿‡ç¨‹ä¸ºä¾‹ï¼Œå®ƒçš„æœç´¢è¿‡ç¨‹å°±æ˜¯è¿™æ ·å­çš„ï¼š</p>
<p><img src="https://blog-picgo-typora.oss-cn-hangzhou.aliyuncs.com/image-20220805093903839.png" alt="image-20220805093903839"></p>
<p>æ¥¼ä¸Šè¿™äº›å½¼æ­¤ç›¸è¿çš„ prototypeï¼Œå°±ç»„æˆäº†ä¸€ä¸ªåŸå‹é“¾ã€‚ æ³¨ï¼š å‡ ä¹æ‰€æœ‰ JavaScript ä¸­çš„å¯¹è±¡éƒ½æ˜¯ä½äºåŸå‹é“¾é¡¶ç«¯çš„ Object çš„å®ä¾‹ï¼Œé™¤äº† Object.prototypeï¼ˆå½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æ‰‹åŠ¨ç”¨ Object.create(null)åˆ›å»ºä¸€ä¸ªæ²¡æœ‰ä»»ä½•åŸå‹çš„å¯¹è±¡ï¼Œé‚£å®ƒä¹Ÿä¸æ˜¯ Object çš„å®ä¾‹ï¼‰ã€‚
ä»¥ä¸Šä¸ºå¤§å®¶ä»‹ç»äº†åŸå‹ã€åŸå‹é“¾ç­‰ JavaScript ä¸­æ ¸å¿ƒçš„åŸºç¡€çŸ¥è¯†ã€‚è¿™äº›ä¸ä»…æ˜¯åŸºç¡€ä¸­çš„åŸºç¡€ï¼Œä¹Ÿæ˜¯é¢è¯•ä¸­çš„é‡ç‚¹ã€‚æ­¤å¤–åœ¨é¢è¯•ä¸­ï¼Œä¸€äº›é¢è¯•å®˜å¯èƒ½ä¼šåˆ»æ„æ··æ·† JavaScript ä¸­åŸå‹èŒƒå¼å’Œå¼ºç±»å‹è¯­è¨€ä¸­åŸå‹æ¨¡å¼çš„åŒºåˆ«ï¼Œå½“ä»–ä»¬è¿™ä¹ˆåšçš„æ—¶å€™ä¸ä¸€å®šæ˜¯å› ä¸ºå¯¹è¯­è¨€ã€å¯¹è®¾è®¡æ¨¡å¼çš„ç†è§£æœ‰é—®é¢˜ï¼Œè€Œå¾ˆæœ‰å¯èƒ½æ˜¯ä¸ºäº†è€ƒå¯Ÿä½ <strong>å¯¹è±¡çš„æ·±æ‹·è´</strong>ã€‚</p>
<h3 id="å¯¹è±¡çš„æ·±æ‹·è´" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡çš„æ·±æ‹·è´" aria-hidden="true">#</a> å¯¹è±¡çš„æ·±æ‹·è´</h3>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¦‚æœæ˜¯ å€¼ç±»å‹ æˆ– nullï¼Œåˆ™ç›´æ¥return</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">"object"</span> <span class="token operator">||</span> obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å®šä¹‰ç»“æœå¯¹è±¡</span>
  <span class="token keyword">let</span> copy <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// å¦‚æœå¯¹è±¡æ˜¯æ•°ç»„ï¼Œåˆ™å®šä¹‰ç»“æœæ•°ç»„</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Array<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    copy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// éå†å¯¹è±¡çš„key</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœkeyæ˜¯å¯¹è±¡çš„è‡ªæœ‰å±æ€§</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// é€’å½’è°ƒç”¨æ·±æ‹·è´æ–¹æ³•</span>
      copy<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> copy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è°ƒç”¨æ·±æ‹·è´æ–¹æ³•ï¼Œè‹¥å±æ€§ä¸ºå€¼ç±»å‹ï¼Œåˆ™ç›´æ¥è¿”å›ï¼›è‹¥å±æ€§ä¸ºå¼•ç”¨ç±»å‹ï¼Œåˆ™é€’å½’éå†ã€‚è¿™å°±æ˜¯æˆ‘ä»¬åœ¨è§£è¿™ä¸€ç±»é¢˜æ—¶çš„æ ¸å¿ƒçš„æ–¹æ³•ã€‚</p>
<h1 id="è£…é¥°å™¨æ¨¡å¼-ç»“æ„å‹" tabindex="-1"><a class="header-anchor" href="#è£…é¥°å™¨æ¨¡å¼-ç»“æ„å‹" aria-hidden="true">#</a> è£…é¥°å™¨æ¨¡å¼ï¼ˆç»“æ„å‹ï¼‰</h1>
<p>å¯¹è±¡è£…ä¸Šå®ƒï¼Œå°±åƒå¼€äº†æŒ‚
è£…é¥°å™¨æ¨¡å¼ï¼Œåˆåè£…é¥°è€…æ¨¡å¼ã€‚å®ƒçš„å®šä¹‰æ˜¯â€œåœ¨ä¸æ”¹å˜åŸå¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡å¯¹å…¶è¿›è¡ŒåŒ…è£…æ‹“å±•ï¼Œä½¿åŸæœ‰å¯¹è±¡å¯ä»¥æ»¡è¶³ç”¨æˆ·çš„æ›´å¤æ‚éœ€æ±‚â€ã€‚</p>
<p><strong>ä¸å…³å¿ƒå®ƒç°æœ‰çš„ä¸šåŠ¡é€»è¾‘æ˜¯å•¥æ ·çš„ï¼Œåªå¯¹å®ƒå·²æœ‰çš„åŠŸèƒ½åšä¸ªæ‹“å±•ï¼Œåªå…³å¿ƒæ‹“å±•å‡ºæ¥çš„é‚£éƒ¨åˆ†æ–°åŠŸèƒ½å¦‚ä½•å®ç°ã€‚</strong></p>
<p>æ ¸å¿ƒæ€æƒ³å°±æ˜¯åªè¿›è¡Œæ·»åŠ ï¼Œä¸ä¿®æ”¹åŸæœ‰é€»è¾‘ã€‚éµå¾ªäº†å•ä¸€èŒè´£åŸåˆ™ã€‚</p>
<h1 id="é€‚é…å™¨æ¨¡å¼-ç»“æ„å‹" tabindex="-1"><a class="header-anchor" href="#é€‚é…å™¨æ¨¡å¼-ç»“æ„å‹" aria-hidden="true">#</a> é€‚é…å™¨æ¨¡å¼ï¼ˆç»“æ„å‹ï¼‰</h1>
<p>å…¼å®¹ä»£ç å°±æ˜¯ä¸€æŠŠæ¢­</p>
<p>é€‚é…å™¨æ¨¡å¼é€šè¿‡<strong>æŠŠä¸€ä¸ªç±»çš„æ¥å£å˜æ¢æˆå®¢æˆ·ç«¯æ‰€æœŸå¾…çš„å¦ä¸€ç§æ¥å£</strong>ï¼Œå¯ä»¥å¸®æˆ‘ä»¬è§£å†³<strong>ä¸å…¼å®¹</strong>çš„é—®é¢˜ã€‚</p>
<p>ä¸¾ä¾‹æ‰‹æœºçš„è€³æœºæ’å­”</p>
<p>æ—§çš„ Ajax æ–¹æ³•</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// å‘é€getè¯·æ±‚</span>
<span class="token function">Ajax</span><span class="token punctuation">(</span>
  <span class="token string">"get"</span><span class="token punctuation">,</span>
  urlåœ°å€<span class="token punctuation">,</span>
  postå…¥å‚<span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æˆåŠŸçš„å›è°ƒé€»è¾‘</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¤±è´¥çš„å›è°ƒé€»è¾‘</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹è€ä»£ç è¿›è¡Œé€‚é…</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// Ajaxé€‚é…å™¨å‡½æ•°ï¼Œå…¥å‚ä¸æ—§æ¥å£ä¿æŒä¸€è‡´</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">AjaxAdapter</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> success<span class="token punctuation">,</span> failed</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> type <span class="token operator">=</span> type<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result<span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// å®é™…çš„è¯·æ±‚å…¨éƒ¨ç”±æ–°æ¥å£å‘èµ·</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">"GET"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> HttpUtils<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">"POST"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> HttpUtils<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å‡è®¾è¯·æ±‚æˆåŠŸå¯¹åº”çš„çŠ¶æ€ç æ˜¯1</span>
    result<span class="token punctuation">.</span>statusCode <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> success
      <span class="token operator">?</span> <span class="token function">success</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token function">failed</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>statusCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ•æ‰ç½‘ç»œé”™è¯¯</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>failed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">failed</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>statusCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ç”¨é€‚é…å™¨é€‚é…æ—§çš„Ajaxæ–¹æ³•</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">Ajax</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> success<span class="token punctuation">,</span> failed</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">AjaxAdapter</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> success<span class="token punctuation">,</span> failed<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="ä»£ç†æ¨¡å¼-ç»“æ„å‹" tabindex="-1"><a class="header-anchor" href="#ä»£ç†æ¨¡å¼-ç»“æ„å‹" aria-hidden="true">#</a> ä»£ç†æ¨¡å¼ï¼ˆç»“æ„å‹ï¼‰</h1>
<p>ä»£ç†æ¨¡å¼ï¼Œå¼å¦‚å…¶åâ€”â€”åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå‡ºäºç§ç§è€ƒè™‘/é™åˆ¶ï¼Œä¸€ä¸ªå¯¹è±¡<strong>ä¸èƒ½ç›´æ¥è®¿é—®</strong>å¦ä¸€ä¸ªå¯¹è±¡ï¼Œéœ€è¦ä¸€ä¸ª<strong>ç¬¬ä¸‰è€…</strong>ï¼ˆä»£ç†ï¼‰ç‰µçº¿æ­æ¡¥ä»è€Œé—´æ¥è¾¾åˆ°è®¿é—®ç›®çš„ï¼Œè¿™æ ·çš„æ¨¡å¼å°±æ˜¯ä»£ç†æ¨¡å¼ã€‚</p>
<h2 id="es6-ä¸­çš„-proxy" tabindex="-1"><a class="header-anchor" href="#es6-ä¸­çš„-proxy" aria-hidden="true">#</a> ES6 ä¸­çš„ Proxy</h2>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

<span class="token comment">// æ™®é€šç§å¯†ä¿¡æ¯</span>
<span class="token keyword">const</span> baseInfo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'career'</span><span class="token punctuation">]</span>
<span class="token comment">// æœ€ç§å¯†ä¿¡æ¯</span>
<span class="token keyword">const</span> privateInfo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'avatar'</span><span class="token punctuation">,</span> <span class="token string">'phone'</span><span class="token punctuation">]</span>

<span class="token comment">// ç”¨æˆ·ï¼ˆåŒäº‹Aï¼‰å¯¹è±¡å®ä¾‹</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token punctuation">(</span>ä¸€äº›å¿…è¦çš„ä¸ªäººä¿¡æ¯<span class="token punctuation">)</span>
    <span class="token literal-property property">isValidated</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">isVIP</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// è§„å®šç¤¼ç‰©çš„æ•°æ®ç»“æ„ç”±typeå’Œvalueç»„æˆ</span>
<span class="token keyword">const</span> present <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'å·§å…‹åŠ›'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä¸ºç”¨æˆ·å¢å¼€presentså­—æ®µå­˜å‚¨ç¤¼ç‰©</span>
<span class="token keyword">const</span> girl <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// å§“å</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'å°ç¾'</span><span class="token punctuation">,</span>
  <span class="token comment">// è‡ªæˆ‘ä»‹ç»</span>
  <span class="token literal-property property">aboutMe</span><span class="token operator">:</span> <span class="token string">'...'</span>ï¼ˆå¤§å®¶è‡ªè¡Œè„‘è¡¥å§ï¼‰
  <span class="token comment">// å¹´é¾„</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
  <span class="token comment">// èŒä¸š</span>
  <span class="token literal-property property">career</span><span class="token operator">:</span> <span class="token string">'teacher'</span><span class="token punctuation">,</span>
  <span class="token comment">// å‡å¤´åƒ</span>
  <span class="token literal-property property">fakeAvatar</span><span class="token operator">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">(</span>æ–°å£ç»“è¡£çš„å›¾ç‰‡åœ°å€ï¼‰
  <span class="token comment">// çœŸå®å¤´åƒ</span>
  <span class="token literal-property property">avatar</span><span class="token operator">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">(</span>è‡ªå·±çš„ç…§ç‰‡åœ°å€<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// æ‰‹æœºå·</span>
  <span class="token literal-property property">phone</span><span class="token operator">:</span> <span class="token number">123456</span><span class="token punctuation">,</span>
  <span class="token comment">// ç¤¼ç‰©æ•°ç»„</span>
  <span class="token literal-property property">presents</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// æ‹’æ”¶50å—ä»¥ä¸‹çš„ç¤¼ç‰©</span>
  <span class="token literal-property property">bottomValue</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
  <span class="token comment">// è®°å½•æœ€è¿‘ä¸€æ¬¡æ”¶åˆ°çš„ç¤¼ç‰©</span>
  <span class="token literal-property property">lastPresent</span><span class="token operator">:</span> present<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ˜é‡‘å©šä»‹æ‰€æ¨å‡ºäº†å°ç¤¼ç‰©åŠŸèƒ½</span>
<span class="token keyword">const</span> JuejinLovers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>girl<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">girl<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>baseInfo<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">!==</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>isValidated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'æ‚¨è¿˜æ²¡æœ‰å®ŒæˆéªŒè¯å“¦'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//...(æ­¤å¤„çœç•¥å…¶å®ƒæœ‰çš„æ²¡çš„å„ç§æ ¡éªŒé€»è¾‘)</span>

    <span class="token comment">// æ­¤å¤„æˆ‘ä»¬è®¤ä¸ºåªæœ‰éªŒè¯è¿‡çš„ç”¨æˆ·æ‰å¯ä»¥è´­ä¹°VIP</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>isValidated <span class="token operator">&amp;&amp;</span> privateInfo<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">!==</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>isVIP<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'åªæœ‰VIPæ‰å¯ä»¥æŸ¥çœ‹è¯¥ä¿¡æ¯å“¦'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">girl<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// æœ€è¿‘ä¸€æ¬¡é€æ¥çš„ç¤¼ç‰©ä¼šå°è¯•èµ‹å€¼ç»™lastPresentå­—æ®µ</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'lastPresent'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span>value <span class="token operator">&lt;</span> girl<span class="token punctuation">.</span>bottomValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'sorryï¼Œæ‚¨çš„ç¤¼ç‰©è¢«æ‹’æ”¶äº†'</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// å¦‚æœæ²¡æœ‰æ‹’æ”¶ï¼Œåˆ™èµ‹å€¼æˆåŠŸï¼ŒåŒæ—¶å¹¶å…¥presentsæ•°ç»„</span>
      girl<span class="token punctuation">.</span>lastPresent <span class="token operator">=</span> val
      girl<span class="token punctuation">.</span>presents <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>girl<span class="token punctuation">.</span>presents<span class="token punctuation">,</span> val<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="äº‹ä»¶ä»£ç†" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶ä»£ç†" aria-hidden="true">#</a> äº‹ä»¶ä»£ç†</h2>
<p>äº‹ä»¶ä»£ç†ï¼Œå¯èƒ½æ˜¯ä»£ç†æ¨¡å¼æœ€å¸¸è§çš„ä¸€ç§åº”ç”¨æ–¹å¼ï¼Œä¹Ÿæ˜¯ä¸€é“å®æ‰“å®çš„é«˜é¢‘é¢è¯•é¢˜ã€‚å®ƒçš„åœºæ™¯æ˜¯ä¸€ä¸ªçˆ¶å…ƒç´ ä¸‹æœ‰å¤šä¸ªå­å…ƒç´ ï¼Œåƒè¿™æ ·ï¼š</p>
<div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>äº‹ä»¶ä»£ç†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>father<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>é“¾æ¥1å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>é“¾æ¥2å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>é“¾æ¥3å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>é“¾æ¥4å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>é“¾æ¥5å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>é“¾æ¥6å·<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html ext-html line-numbers-mode"><pre v-pre class="language-html"><code>// å‡å¦‚ä¸ç”¨ä»£ç†æ¨¡å¼ï¼Œæˆ‘ä»¬å°†å¾ªç¯å®‰è£…ç›‘å¬å‡½æ•° const aNodes =
document.getElementById('father').getElementsByTagName('a') const aLength =
aNodes.length for(let i=0;i&lt;aLength;i++) { aNodes[i].addEventListener('click',
function(e) { e.preventDefault() alert(`æˆ‘æ˜¯${aNodes[i].innerText}`) }) }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€ƒè™‘åˆ°äº‹ä»¶æœ¬èº«å…·æœ‰â€œå†’æ³¡â€çš„ç‰¹æ€§ï¼Œå½“æˆ‘ä»¬ç‚¹å‡» a å…ƒç´ æ—¶ï¼Œç‚¹å‡»äº‹ä»¶ä¼šâ€œå†’æ³¡â€åˆ°çˆ¶å…ƒç´  div ä¸Šï¼Œä»è€Œè¢«ç›‘å¬åˆ°ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œç‚¹å‡»äº‹ä»¶çš„ç›‘å¬å‡½æ•°åªéœ€è¦åœ¨ div å…ƒç´ ä¸Šè¢«ç»‘å®šä¸€æ¬¡å³å¯ï¼Œè€Œä¸éœ€è¦åœ¨å­å…ƒç´ ä¸Šè¢«ç»‘å®š N æ¬¡â€”â€”è¿™ç§åšæ³•å°±æ˜¯äº‹ä»¶ä»£ç†ï¼Œå®ƒå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜æˆ‘ä»¬ä»£ç çš„æ€§èƒ½ã€‚</p>
<h3 id="äº‹ä»¶ä»£ç†çš„å®ç°" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶ä»£ç†çš„å®ç°" aria-hidden="true">#</a> äº‹ä»¶ä»£ç†çš„å®ç°</h3>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// è·å–çˆ¶å…ƒç´ </span>
<span class="token keyword">const</span> father <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"father"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ç»™çˆ¶å…ƒç´ å®‰è£…ä¸€æ¬¡ç›‘å¬å‡½æ•°</span>
father<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¯†åˆ«æ˜¯å¦æ˜¯ç›®æ ‡å­å…ƒç´ </span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>tagName <span class="token operator">===</span> <span class="token string">"A"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä»¥ä¸‹æ˜¯ç›‘å¬å‡½æ•°çš„å‡½æ•°ä½“</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æˆ‘æ˜¯</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ç§åšæ³•ä¸‹ï¼Œæˆ‘ä»¬çš„ç‚¹å‡»æ“ä½œå¹¶ä¸ä¼šç›´æ¥è§¦åŠç›®æ ‡å­å…ƒç´ ï¼Œè€Œæ˜¯ç”±çˆ¶å…ƒç´ å¯¹äº‹ä»¶è¿›è¡Œå¤„ç†å’Œåˆ†å‘ã€é—´æ¥åœ°å°†å…¶ä½œç”¨äºå­å…ƒç´ ï¼Œå› æ­¤è¿™ç§æ“ä½œä»æ¨¡å¼ä¸Šåˆ’åˆ†å±äºä»£ç†æ¨¡å¼ã€‚</p>
<h2 id="ç¼“å­˜ä»£ç†" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜ä»£ç†" aria-hidden="true">#</a> ç¼“å­˜ä»£ç†</h2>
<p>ç¼“å­˜ä»£ç†æ¯”è¾ƒå¥½ç†è§£ï¼Œå®ƒåº”ç”¨äºä¸€äº›è®¡ç®—é‡è¾ƒå¤§çš„åœºæ™¯é‡Œã€‚åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦â€œç”¨ç©ºé—´æ¢æ—¶é—´â€â€”â€”å½“æˆ‘ä»¬éœ€è¦ç”¨åˆ°æŸä¸ªå·²ç»è®¡ç®—è¿‡çš„å€¼çš„æ—¶å€™ï¼Œä¸æƒ³å†è€—æ—¶è¿›è¡ŒäºŒæ¬¡è®¡ç®—ï¼Œè€Œæ˜¯å¸Œæœ›èƒ½ä»å†…å­˜é‡Œå»å–å‡ºç°æˆçš„è®¡ç®—ç»“æœã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œå°±éœ€è¦ä¸€ä¸ªä»£ç†æ¥å¸®æˆ‘ä»¬åœ¨è¿›è¡Œè®¡ç®—çš„åŒæ—¶ï¼Œè¿›è¡Œè®¡ç®—ç»“æœçš„ç¼“å­˜äº†ã€‚
ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„ä¾‹å­ï¼Œæ˜¯å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œæ±‚å’Œï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// addAllæ–¹æ³•ä¼šå¯¹ä½ ä¼ å…¥çš„æ‰€æœ‰å‚æ•°åšæ±‚å’Œæ“ä½œ</span>
<span class="token keyword">const</span> <span class="token function-variable function">addAll</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"è¿›è¡Œäº†ä¸€æ¬¡æ–°è®¡ç®—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> len <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">+=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸ºæ±‚å’Œæ–¹æ³•åˆ›å»ºä»£ç†</span>
<span class="token keyword">const</span> proxyAddAll <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ±‚å’Œç»“æœçš„ç¼“å­˜æ± </span>
  <span class="token keyword">const</span> resultCache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å°†å…¥å‚è½¬åŒ–ä¸ºä¸€ä¸ªå”¯ä¸€çš„å…¥å‚å­—ç¬¦ä¸²</span>
    <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ£€æŸ¥æœ¬æ¬¡å…¥å‚æ˜¯å¦æœ‰å¯¹åº”çš„è®¡ç®—ç»“æœ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>args <span class="token keyword">in</span> resultCache<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœæœ‰ï¼Œåˆ™è¿”å›ç¼“å­˜æ± é‡Œç°æˆçš„ç»“æœ</span>
      <span class="token keyword">return</span> resultCache<span class="token punctuation">[</span>args<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>resultCache<span class="token punctuation">[</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">addAll</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æŠŠè¿™ä¸ªæ–¹æ³•ä¸¢è¿›æ§åˆ¶å°ï¼Œå°è¯•åŒä¸€å¥—å…¥å‚ä¸¤æ¬¡ï¼Œç»“æœå–œäººï¼š</p>
<p><img src="https://blog-picgo-typora.oss-cn-hangzhou.aliyuncs.com/image-20220805094028579.png" alt="image-20220805094028579">
æˆ‘ä»¬å‘ç° proxyAddAll é’ˆå¯¹é‡å¤çš„å…¥å‚åªä¼šè®¡ç®—ä¸€æ¬¡ï¼Œè¿™å°†å¤§å¤§èŠ‚çœè®¡ç®—è¿‡ç¨‹ä¸­çš„æ—¶é—´å¼€é”€ã€‚ç°åœ¨æˆ‘ä»¬æœ‰ 6 ä¸ªå…¥å‚ï¼Œå¯èƒ½è¿˜çœ‹ä¸å‡ºæ¥ï¼Œå½“æˆ‘ä»¬é’ˆå¯¹å¤§é‡å…¥å‚ã€åšåå¤è®¡ç®—æ—¶ï¼Œç¼“å­˜ä»£ç†çš„ä¼˜åŠ¿å°†å¾—åˆ°æ›´å……åˆ†çš„å‡¸æ˜¾ã€‚</p>
<h2 id="ä¿æŠ¤ä»£ç†" tabindex="-1"><a class="header-anchor" href="#ä¿æŠ¤ä»£ç†" aria-hidden="true">#</a> ä¿æŠ¤ä»£ç†</h2>
<p>å¼€å©šä»‹æ‰€çš„æ—¶å€™ï¼Œä¸ºäº†ä¿æŠ¤ç”¨æˆ·çš„ç§äººä¿¡æ¯ï¼Œæˆ‘ä»¬ä¼šåœ¨åŒäº‹å“¥è®¿é—®å°ç¾çš„å¹´é¾„çš„æ—¶å€™ï¼Œå»æ ¡éªŒåŒäº‹å“¥æ˜¯å¦å·²ç»é€šè¿‡äº†æˆ‘ä»¬çš„å®åè®¤è¯ï¼›ä¸ºäº†ç¡®ä¿<s>å©šä»‹æ‰€çš„åˆ©ç›Š</s>åŒäº‹å“¥ç¡®å®æ˜¯ä¸€ä½æœ‰è¯šæ„çš„ç”·å£«ï¼Œå½“ä»–æƒ³è·å–å°ç¾çš„è”ç³»æ–¹å¼æ—¶ï¼Œæˆ‘ä»¬ä¼šæ ¡éªŒä»–æ˜¯å¦å…·æœ‰ VIP èµ„æ ¼ã€‚æ‰€è°“â€œä¿æŠ¤ä»£ç†â€ï¼Œå°±æ˜¯åœ¨è®¿é—®å±‚é¢åšæ–‡ç« ï¼Œåœ¨ getter å’Œ setter å‡½æ•°é‡Œå»è¿›è¡Œæ ¡éªŒå’Œæ‹¦æˆªï¼Œç¡®ä¿ä¸€éƒ¨åˆ†å˜é‡æ˜¯å®‰å…¨çš„ã€‚
å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸ŠèŠ‚ä¸­æˆ‘ä»¬æåˆ°çš„ Proxyï¼Œå®ƒæœ¬èº«å°±æ˜¯ä¸ºæ‹¦æˆªè€Œç”Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›®å‰å®ç°ä¿æŠ¤ä»£ç†æ—¶ï¼Œè€ƒè™‘çš„é¦–è¦æ–¹æ¡ˆå°±æ˜¯ ES6 ä¸­çš„ Proxyã€‚</p>
<h1 id="ç­–ç•¥æ¨¡å¼-è¡Œä¸ºå‹" tabindex="-1"><a class="header-anchor" href="#ç­–ç•¥æ¨¡å¼-è¡Œä¸ºå‹" aria-hidden="true">#</a> ç­–ç•¥æ¨¡å¼ï¼ˆè¡Œä¸ºå‹ï¼‰</h1>
<p>é‡æ„å°èƒ½æ‰‹ï¼Œæ‹†åˆ†â€œèƒ–é€»è¾‘â€</p>
<p>å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥, å¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚</p>
<p>åŸå…ˆçš„ä»£ç </p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"pre"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"onSale"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†è¿”åœºä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"back"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†å°é²œä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"fresh"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†æ–°äººä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"newUser"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å•ä¸€åŠŸèƒ½æ”¹é€ " tabindex="-1"><a class="header-anchor" href="#å•ä¸€åŠŸèƒ½æ”¹é€ " aria-hidden="true">#</a> å•ä¸€åŠŸèƒ½æ”¹é€ </h2>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
<span class="token keyword">function</span> <span class="token function">prePrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
<span class="token keyword">function</span> <span class="token function">onSalePrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†è¿”åœºä»·</span>
<span class="token keyword">function</span> <span class="token function">backPrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†å°é²œä»·</span>
<span class="token keyword">function</span> <span class="token function">freshPrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"pre"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">prePrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"onSale"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">onSalePrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†è¿”åœºä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"back"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">backPrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†å°é²œä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"fresh"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">freshPrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ°è¿™é‡Œï¼Œåœ¨å•ä¸€åŠŸèƒ½åŸåˆ™çš„æŒ‡å¼•ä¸‹ï¼Œæˆ‘ä»¬å·²ç»è§£å†³äº†ä¸€åŠçš„é—®é¢˜ã€‚
æˆ‘ä»¬ç°åœ¨æ¥æ‹ä¸€ä¸‹ï¼Œå…¶å®è¿™ä¸ªè¯¢ä»·é€»è¾‘æ•´ä½“ä¸Šæ¥çœ‹åªæœ‰ä¸¤ä¸ªå…³é”®åŠ¨ä½œï¼š</p>
<blockquote>
<p>è¯¢ä»·é€»è¾‘çš„åˆ†å‘ â€”â€”&gt; è¯¢ä»·é€»è¾‘çš„æ‰§è¡Œ</p>
</blockquote>
<p>åœ¨æ”¹é€ çš„ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å·²ç»æŠŠâ€œè¯¢ä»·é€»è¾‘çš„æ‰§è¡Œâ€ç»™æ‘˜äº†å‡ºå»ï¼Œå¹¶ä¸”å®ç°äº†ä¸åŒè¯¢ä»·é€»è¾‘ä¹‹é—´çš„è§£è€¦ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è¦æ‹¿â€œåˆ†å‘â€è¿™ä¸ªåŠ¨ä½œå¼€åˆ€ã€‚</p>
<h2 id="å¼€æ”¾å°é—­æ”¹é€ " tabindex="-1"><a class="header-anchor" href="#å¼€æ”¾å°é—­æ”¹é€ " aria-hidden="true">#</a> å¼€æ”¾å°é—­æ”¹é€ </h2>
<p>å‰©ä¸‹ä¸€åŠçš„é—®é¢˜æ˜¯å•¥å‘¢ï¼Ÿå°±æ˜¯å’±ä»¬ä¸Šé¢è¯´çš„é‚£ä¸ªæ–°äººä»·çš„é—®é¢˜â€”â€”è¿™ä¼šå„¿æˆ‘è¦æƒ³ç»™ askPrice å¢åŠ æ–°äººè¯¢ä»·é€»è¾‘ï¼Œæˆ‘è¯¥å’‹æ•´ï¼Ÿæˆ‘åªèƒ½è¿™ä¹ˆæ¥ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
<span class="token keyword">function</span> <span class="token function">prePrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
<span class="token keyword">function</span> <span class="token function">onSalePrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†è¿”åœºä»·</span>
<span class="token keyword">function</span> <span class="token function">backPrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> originPrice<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†å°é²œä»·</span>
<span class="token keyword">function</span> <span class="token function">freshPrice</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¤„ç†é¢„çƒ­ä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"pre"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">prePrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¤„ç†å¤§ä¿ƒä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"onSale"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">onSalePrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†è¿”åœºä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"back"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">backPrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¤„ç†å°é²œä»·</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">"fresh"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">freshPrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ askPrice é‡Œé¢ï¼Œæˆ‘ä»¬æ–°å¢äº†ä¸€ä¸ª if-else åˆ¤æ–­ã€‚å¯ä»¥çœ‹å‡ºï¼Œè¿™æ ·å…¶å®è¿˜æ˜¯åœ¨ä¿®æ”¹ askPrice çš„å‡½æ•°ä½“ï¼Œæ²¡æœ‰å®ç°â€œå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­â€çš„æ•ˆæœã€‚
é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšï¼Ÿæˆ‘ä»¬ä»”ç»†æƒ³æƒ³ï¼Œæ¥¼ä¸Šç”¨äº†è¿™ä¹ˆå¤š if-elseï¼Œæˆ‘ä»¬çš„ç›®çš„åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ä¸æ˜¯å°±æ˜¯ä¸ºäº†æŠŠ è¯¢ä»·æ ‡ç­¾-è¯¢ä»·å‡½æ•° è¿™ä¸ªæ˜ å°„å…³ç³»ç»™æ˜ç¡®ä¸‹æ¥ï¼Ÿé‚£ä¹ˆåœ¨ JS ä¸­ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ—¢èƒ½å¤Ÿæ—¢å¸®æˆ‘ä»¬æ˜ç¡®æ˜ å°„å…³ç³»ï¼ŒåŒæ—¶ä¸ç ´åä»£ç çš„çµæ´»æ€§çš„æ–¹æ³•å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯<strong>å¯¹è±¡æ˜ å°„</strong>ï¼
å’±ä»¬å®Œå…¨å¯ä»¥æŠŠè¯¢ä»·ç®—æ³•å…¨éƒ½æ”¶æ•›åˆ°ä¸€ä¸ªå¯¹è±¡é‡Œå»å˜›ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// å®šä¹‰ä¸€ä¸ªè¯¢ä»·å¤„ç†å™¨å¯¹è±¡</span>
<span class="token keyword">const</span> priceProcessor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">pre</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onSale</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">back</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">>=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">fresh</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“æˆ‘ä»¬æƒ³ä½¿ç”¨å…¶ä¸­æŸä¸ªè¯¢ä»·ç®—æ³•çš„æ—¶å€™ï¼šé€šè¿‡æ ‡ç­¾åå»å®šä½å°±å¥½äº†ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// è¯¢ä»·å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> priceProcessor<span class="token punctuation">[</span>tag<span class="token punctuation">]</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="çŠ¶æ€æ¨¡å¼-è¡Œä¸ºå‹" tabindex="-1"><a class="header-anchor" href="#çŠ¶æ€æ¨¡å¼-è¡Œä¸ºå‹" aria-hidden="true">#</a> çŠ¶æ€æ¨¡å¼ï¼ˆè¡Œä¸ºå‹ï¼‰</h1>
<p>çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼å®›å¦‚ä¸€å¯¹å­ªç”Ÿå…„å¼Ÿâ€”â€”å®ƒä»¬é•¿å¾—å¾ˆåƒã€è§£å†³çš„é—®é¢˜ä¹Ÿå¯ä»¥è¯´æ²¡å•¥æœ¬è´¨ä¸Šçš„å·®åˆ«ã€‚</p>
<blockquote>
<p>çŠ¶æ€æ¨¡å¼ä¸»è¦è§£å†³çš„æ˜¯å½“æ§åˆ¶ä¸€ä¸ªå¯¹è±¡çŠ¶æ€çš„æ¡ä»¶è¡¨è¾¾å¼è¿‡äºå¤æ‚æ—¶çš„æƒ…å†µã€‚æŠŠçŠ¶æ€çš„åˆ¤æ–­é€»è¾‘è½¬ç§»åˆ°è¡¨ç¤ºä¸åŒçŠ¶æ€çš„ä¸€ç³»åˆ—ç±»ä¸­ï¼Œå¯ä»¥æŠŠå¤æ‚çš„åˆ¤æ–­é€»è¾‘ç®€åŒ–ã€‚</p>
</blockquote>
<h2 id="ä¸€å°å’–å•¡æœºçš„è¯ç”Ÿ" tabindex="-1"><a class="header-anchor" href="#ä¸€å°å’–å•¡æœºçš„è¯ç”Ÿ" aria-hidden="true">#</a> ä¸€å°å’–å•¡æœºçš„è¯ç”Ÿ</h2>
<p>æ—§ä»£ç </p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">CoffeeMaker</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
    è¿™é‡Œç•¥å»å’–å•¡æœºä¸­ä¸å’–å•¡çŠ¶æ€åˆ‡æ¢æ— å…³çš„ä¸€äº›åˆå§‹åŒ–é€»è¾‘
  **/</span>
    <span class="token comment">// åˆå§‹åŒ–çŠ¶æ€ï¼Œæ²¡æœ‰åˆ‡æ¢ä»»ä½•å’–å•¡æ¨¡å¼</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"init"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å…³æ³¨å’–å•¡æœºçŠ¶æ€åˆ‡æ¢å‡½æ•°</span>
  <span class="token function">changeState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®°å½•å½“å‰çŠ¶æ€</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">"american"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è¿™é‡Œç”¨ console ä»£æŒ‡å’–å•¡åˆ¶ä½œæµç¨‹çš„ä¸šåŠ¡é€»è¾‘</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆ‘åªåé»‘å’–å•¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">"latte"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ç»™é»‘å’–å•¡åŠ ç‚¹å¥¶</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">"vanillaLatte"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"é»‘å’–å•¡åŠ ç‚¹å¥¶å†åŠ é¦™è‰ç³–æµ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">"mocha"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"é»‘å’–å•¡åŠ ç‚¹å¥¶å†åŠ ç‚¹å·§å…‹åŠ›"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="èŒè´£åˆ†ç¦»" tabindex="-1"><a class="header-anchor" href="#èŒè´£åˆ†ç¦»" aria-hidden="true">#</a> èŒè´£åˆ†ç¦»</h2>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">CoffeeMaker</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
    è¿™é‡Œç•¥å»å’–å•¡æœºä¸­ä¸å’–å•¡çŠ¶æ€åˆ‡æ¢æ— å…³çš„ä¸€äº›åˆå§‹åŒ–é€»è¾‘
  **/</span>
    <span class="token comment">// åˆå§‹åŒ–çŠ¶æ€ï¼Œæ²¡æœ‰åˆ‡æ¢ä»»ä½•å’–å•¡æ¨¡å¼</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"init"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">changeState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®°å½•å½“å‰çŠ¶æ€</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">"american"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è¿™é‡Œç”¨ console ä»£æŒ‡å’–å•¡åˆ¶ä½œæµç¨‹çš„ä¸šåŠ¡é€»è¾‘</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">americanProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">"latte"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">"vanillaLatte"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">vanillaLatteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token string">"mocha"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">mochaProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">americanProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆ‘åªåé»‘å’–å•¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">latteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">americanProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"åŠ ç‚¹å¥¶"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">vanillaLatteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å†åŠ é¦™è‰ç³–æµ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">mochaProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latteProcress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å†åŠ å·§å…‹åŠ›"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> mk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CoffeeMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mk<span class="token punctuation">.</span><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token string">"latte"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å¼€æ”¾å°é—­" tabindex="-1"><a class="header-anchor" href="#å¼€æ”¾å°é—­" aria-hidden="true">#</a> å¼€æ”¾å°é—­</h2>
<p>å¤ç”¨çš„é—®é¢˜è§£å†³äº†ï¼Œif-else å´ä»ç„¶æ´»å¾—å¥½å¥½çš„ã€‚
ç°åœ¨å’±ä»¬å‡å¦‚è¦å¢åŠ â€æ°”æ³¡ç¾å¼â€œè¿™ä¸ªå’–å•¡å“ç§ï¼Œå°±ä¸å¾—ä¸å»ä¿®æ”¹ changeState çš„å‡½æ•°é€»è¾‘ï¼Œè¿™è¿åäº†å¼€æ”¾å°é—­çš„åŸåˆ™ã€‚
åŒæ—¶ï¼Œä¸€ä¸ªå‡½æ•°é‡Œæ”¶æ•›è¿™ä¹ˆå¤šåˆ¤æ–­ï¼Œä¹Ÿç€å®ä¸å¤Ÿä½“é¢ã€‚å’±ä»¬ç°åœ¨è¦åƒç­–ç•¥æ¨¡å¼ä¸€æ ·ï¼Œæƒ³åŠæ³•æŠŠå’–å•¡æœºçŠ¶æ€å’Œå’–å•¡åˆ¶ä½œå·¥åºä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼ˆä¹Ÿå°±æ˜¯å’±ä»¬ä¸ŠèŠ‚è°ˆåˆ°çš„åˆ†å‘è¿‡ç¨‹ï¼‰ç”¨ä¸€ä¸ªæ›´ä¼˜é›…åœ°æ–¹å¼åšæ‰ã€‚å¦‚æœä½ ç­–ç•¥æ¨¡å¼æŒæ¡å¾—è¶³å¤Ÿå¥½ï¼Œä½ ä¼šç¬¬ä¸€æ—¶é—´åæ˜ å‡ºå¯¹è±¡æ˜ å°„çš„æ–¹æ¡ˆï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> stateToProcessor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">american</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆ‘åªåé»‘å’–å•¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">american</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"åŠ ç‚¹å¥¶"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">vanillaLatte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å†åŠ é¦™è‰ç³–æµ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mocha</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å†åŠ å·§å…‹åŠ›"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">CoffeeMaker</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
    è¿™é‡Œç•¥å»å’–å•¡æœºä¸­ä¸å’–å•¡çŠ¶æ€åˆ‡æ¢æ— å…³çš„ä¸€äº›åˆå§‹åŒ–é€»è¾‘
  **/</span>
    <span class="token comment">// åˆå§‹åŒ–çŠ¶æ€ï¼Œæ²¡æœ‰åˆ‡æ¢ä»»ä½•å’–å•¡æ¨¡å¼</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"init"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å…³æ³¨å’–å•¡æœºçŠ¶æ€åˆ‡æ¢å‡½æ•°</span>
  <span class="token function">changeState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®°å½•å½“å‰çŠ¶æ€</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token comment">// è‹¥çŠ¶æ€ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stateToProcessor<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    stateToProcessor<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> mk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CoffeeMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mk<span class="token punctuation">.</span><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token string">"latte"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“æˆ‘ä»¬è¿™ä¹ˆåšæ—¶ï¼Œå…¶å®å·²ç»å®ç°äº†ä¸€ä¸ª js ç‰ˆæœ¬çš„çŠ¶æ€æ¨¡å¼ã€‚
ä½†è¿™é‡Œæœ‰ä¸€ç‚¹å¤§å®¶éœ€è¦å¼•èµ·æ³¨æ„ï¼šè¿™ç§æ–¹æ³•ä»…ä»…æ˜¯çœ‹ä¸Šå»å®Œç¾æ— ç¼ºï¼Œå…¶ä¸­å´æš—å«ä¸€ä¸ªéå¸¸é‡è¦çš„éšæ‚£â€”â€”stateToProcessor é‡Œçš„å·¥åºå‡½æ•°ï¼Œæ„ŸçŸ¥ä¸åˆ°å’–å•¡æœºçš„å†…éƒ¨çŠ¶å†µã€‚</p>
<h2 id="ç­–ç•¥ä¸çŠ¶æ€çš„è¾¨æ" tabindex="-1"><a class="header-anchor" href="#ç­–ç•¥ä¸çŠ¶æ€çš„è¾¨æ" aria-hidden="true">#</a> ç­–ç•¥ä¸çŠ¶æ€çš„è¾¨æ</h2>
<p>æ€ä¹ˆç†è§£è¿™ä¸ªé—®é¢˜ï¼Ÿå¤§å®¶çŸ¥é“ï¼Œç­–ç•¥æ¨¡å¼æ˜¯å¯¹ç®—æ³•çš„å°è£…ã€‚ç®—æ³•å’ŒçŠ¶æ€å¯¹åº”çš„è¡Œä¸ºå‡½æ•°è™½ç„¶æœ¬è´¨ä¸Šéƒ½æ˜¯è¡Œä¸ºï¼Œä½†æ˜¯ç®—æ³•çš„ç‹¬ç«‹æ€§å¯é«˜å¤šäº†ã€‚
æ¯”å¦‚è¯´æˆ‘ä¸€ä¸ªè¯¢ä»·ç®—æ³•ï¼Œæˆ‘åªéœ€è¦è¯»å–ä¸€ä¸ªæ•°å­—ï¼Œæˆ‘å°±èƒ½å•ªå•ªä¸‰ä¸‹äº”é™¤äºŒç»™ä½ åå‡ºå¦ä¸€ä¸ªæ•°å­—ä½œä¸ºè¿”å›ç»“æœâ€”â€”å®ƒå’Œè®¡ç®—ä¸»ä½“ä¹‹é—´å¯ä»¥æ˜¯åˆ†ç¦»çš„ï¼Œæˆ‘ä»¬åªè¦å…³æ³¨è®¡ç®—é€»è¾‘æœ¬èº«å°±å¯ä»¥äº†ã€‚
ä½†çŠ¶æ€å¯ä¸ä¸€æ ·äº†ã€‚æ‹¿å’±ä»¬å’–å•¡æœºæ¥è¯´ï¼Œä¸ºäº†å¥½æ‡‚ï¼Œå’±å†™ä»£ç çš„æ—¶å€™æŠŠçœŸæ­£å’–å•¡çš„åˆ¶ä½œå·¥åºç”¨ console æ¥è¡¨ç¤ºäº†ã€‚ä½†å¤§å®¶éƒ½çŸ¥é“ï¼Œåšå’–å•¡è¦è€ƒè™‘çš„ä¸œè¥¿å¯å¤ªå¤šäº†ã€‚ æ¯”å¦‚å’±ä»¬åšæ‹¿é“ï¼Œæ‹¿é“é‡Œçš„ç‰›å¥¶ä»å“ªæ¥ï¼Œæ˜¯ä¸æ˜¯ä»å’–å•¡æœºçš„æŸä¸ªå‚¨ç‰©ç©ºé—´é‡Œå»å–ï¼Ÿå†æ¯”å¦‚æˆ‘ä»¬è¡Œä¸ºå‡½æ•°æ˜¯ä¸æ˜¯åº”è¯¥æ—¶åˆ»æ„ŸçŸ¥å’–å•¡æœºæ¯ç§åŸææ–™çš„ç”¨é‡ã€è¿›è€Œåˆ¤æ–­è‡ªå·±çš„å·¥åºè¿˜èƒ½ä¸èƒ½å¦‚æœŸæ‰§è¡Œä¸‹å»ï¼Ÿè¿™å°±å†³å®šäº†è¡Œä¸ºå‡½æ•°å¿…é¡»èƒ½å¾ˆæ–¹ä¾¿åœ°æ‹¿åˆ°å’–å•¡æœºè¿™ä¸ªä¸»ä½“çš„å„ç§ä¿¡æ¯â€”â€”å®ƒå¿…é¡»å¾—å¯¹ä¸»ä½“æœ‰æ„ŸçŸ¥æ‰è¡Œã€‚
ç­–ç•¥æ¨¡å¼å’ŒçŠ¶æ€æ¨¡å¼ç¡®å®æ˜¯ç›¸ä¼¼çš„ï¼Œå®ƒä»¬éƒ½å°è£…è¡Œä¸ºã€éƒ½é€šè¿‡å§”æ‰˜æ¥å®ç°è¡Œä¸ºåˆ†å‘ã€‚
ä½†ç­–ç•¥æ¨¡å¼ä¸­çš„è¡Œä¸ºå‡½æ•°æ˜¯â€æ½‡æ´’â€œçš„è¡Œä¸ºå‡½æ•°ï¼Œå®ƒä»¬ä¸ä¾èµ–è°ƒç”¨ä¸»ä½“ã€äº’ç›¸å¹³è¡Œã€å„è‡ªä¸ºæ”¿ï¼Œäº•æ°´ä¸çŠ¯æ²³æ°´ã€‚è€Œ<strong>çŠ¶æ€æ¨¡å¼ä¸­çš„è¡Œä¸ºå‡½æ•°ï¼Œé¦–å…ˆæ˜¯å’ŒçŠ¶æ€ä¸»ä½“ä¹‹é—´å­˜åœ¨ç€å…³è”ï¼Œç”±çŠ¶æ€ä¸»ä½“æŠŠå®ƒä»¬ä¸²åœ¨ä¸€èµ·ï¼›å¦ä¸€æ–¹é¢ï¼Œæ­£å› ä¸ºå…³è”ç€åŒæ ·çš„ä¸€ä¸ªï¼ˆæˆ–ä¸€ç±»ï¼‰ä¸»ä½“ï¼Œæ‰€ä»¥ä¸åŒçŠ¶æ€å¯¹åº”çš„è¡Œä¸ºå‡½æ•°å¯èƒ½å¹¶ä¸ä¼šç‰¹åˆ«å‰²è£‚ã€‚</strong></p>
<h2 id="è¿›ä¸€æ­¥æ”¹é€ " tabindex="-1"><a class="header-anchor" href="#è¿›ä¸€æ­¥æ”¹é€ " aria-hidden="true">#</a> è¿›ä¸€æ­¥æ”¹é€ </h2>
<p>æŒ‰ç…§æˆ‘ä»¬è¿™ä¸€é€šæè¿°ï¼Œå½“åŠ¡ä¹‹æ€¥æ˜¯è¦æŠŠå’–å•¡æœºå’Œå®ƒçš„çŠ¶æ€å¤„ç†å‡½æ•°å»ºç«‹å…³è”ã€‚
æŠŠçŠ¶æ€-è¡Œä¸ºæ˜ å°„å¯¹è±¡ä½œä¸ºä¸»ä½“ç±»å¯¹åº”å®ä¾‹çš„ä¸€ä¸ªå±æ€§æ·»åŠ è¿›å»å°±è¡Œäº†ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">CoffeeMaker</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
    è¿™é‡Œç•¥å»å’–å•¡æœºä¸­ä¸å’–å•¡çŠ¶æ€åˆ‡æ¢æ— å…³çš„ä¸€äº›åˆå§‹åŒ–é€»è¾‘
  **/</span>
    <span class="token comment">// åˆå§‹åŒ–çŠ¶æ€ï¼Œæ²¡æœ‰åˆ‡æ¢ä»»ä½•å’–å•¡æ¨¡å¼</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"init"</span><span class="token punctuation">;</span>
    <span class="token comment">// åˆå§‹åŒ–ç‰›å¥¶çš„å­˜å‚¨é‡</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>leftMilk <span class="token operator">=</span> <span class="token string">"500ml"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  stateToProcessor <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">that</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
    <span class="token function">american</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å°è¯•åœ¨è¡Œä¸ºå‡½æ•°é‡Œæ‹¿åˆ°å’–å•¡æœºå®ä¾‹çš„ä¿¡æ¯å¹¶è¾“å‡º</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å’–å•¡æœºç°åœ¨çš„ç‰›å¥¶å­˜å‚¨é‡æ˜¯:"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>that<span class="token punctuation">.</span>leftMilk<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆ‘åªåé»‘å’–å•¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">american</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"åŠ ç‚¹å¥¶"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">vanillaLatte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å†åŠ é¦™è‰ç³–æµ†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">mocha</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å†åŠ å·§å…‹åŠ›"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// å…³æ³¨å’–å•¡æœºçŠ¶æ€åˆ‡æ¢å‡½æ•°</span>
  <span class="token function">changeState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>stateToProcessor<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stateToProcessor<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> mk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CoffeeMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mk<span class="token punctuation">.</span><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token string">"latte"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ stateToProcessor è½»æ¾æ‹¿åˆ°å’–å•¡æœºçš„å®ä¾‹å¯¹è±¡ï¼Œè¿›è€Œæ„ŸçŸ¥å’–å•¡æœºè¿™ä¸ªä¸»ä½“äº†ã€‚</p>
<h1 id="è§‚å¯Ÿè€…æ¨¡å¼-è¡Œä¸ºå‹" tabindex="-1"><a class="header-anchor" href="#è§‚å¯Ÿè€…æ¨¡å¼-è¡Œä¸ºå‹" aria-hidden="true">#</a> è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆè¡Œä¸ºå‹ï¼‰</h1>
<p>é¬¼æ•…äº‹ï¼šäº§å“ç»ç†æ‹‰äº†ä¸€ä¸ªé’‰é’‰ç¾¤</p>
<blockquote>
<p>è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªç›®æ ‡å¯¹è±¡ï¼Œå½“è¿™ä¸ªç›®æ ‡å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°ã€‚ â€”â€” Graphic Design Patterns</p>
</blockquote>
<h1 id="ä»£ç å®ç°" tabindex="-1"><a class="header-anchor" href="#ä»£ç å®ç°" aria-hidden="true">#</a> ä»£ç å®ç°</h1>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// å®šä¹‰å‘å¸ƒè€…ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">Publisher</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Publisher created'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¢åŠ è®¢é˜…è€…</span>
  <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Publisher.add invoked'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ç§»é™¤è®¢é˜…è€…</span>
  <span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Publisher.remove invoked'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">===</span> observer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…</span>
  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Publisher.notify invoked'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      observer<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token comment">// å®šä¹‰è®¢é˜…è€…ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Observer created'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Observer.update invoked'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token comment">// å®šä¹‰è®¢é˜…è€…ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Observer created'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Observer.update invoked'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name">DeveloperObserver</span> <span class="token keyword">extends</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// éœ€æ±‚æ–‡æ¡£ä¸€å¼€å§‹è¿˜ä¸å­˜åœ¨ï¼Œprdåˆå§‹ä¸ºç©ºå¯¹è±¡</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DeveloperObserver created'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// é‡å†™ä¸€ä¸ªå…·ä½“çš„updateæ–¹æ³•</span>
    <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">publisher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DeveloperObserver.update invoked'</span><span class="token punctuation">)</span>
        <span class="token comment">// æ›´æ–°éœ€æ±‚æ–‡æ¡£</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> publisher<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// è°ƒç”¨å·¥ä½œå‡½æ•°</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// workæ–¹æ³•ï¼Œä¸€ä¸ªä¸“é—¨æ¬ç –çš„æ–¹æ³•</span>
    <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–éœ€æ±‚æ–‡æ¡£</span>
        <span class="token keyword">const</span> prd <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prdState
        <span class="token comment">// å¼€å§‹åŸºäºéœ€æ±‚æ–‡æ¡£æä¾›çš„ä¿¡æ¯æ¬ç –ã€‚ã€‚ã€‚</span>
        <span class="token operator">...</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'996 begins...'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name">DeveloperObserver</span> <span class="token keyword">extends</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// éœ€æ±‚æ–‡æ¡£ä¸€å¼€å§‹è¿˜ä¸å­˜åœ¨ï¼Œprdåˆå§‹ä¸ºç©ºå¯¹è±¡</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DeveloperObserver created'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// é‡å†™ä¸€ä¸ªå…·ä½“çš„updateæ–¹æ³•</span>
    <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">publisher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DeveloperObserver.update invoked'</span><span class="token punctuation">)</span>
        <span class="token comment">// æ›´æ–°éœ€æ±‚æ–‡æ¡£</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> publisher<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// è°ƒç”¨å·¥ä½œå‡½æ•°</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// workæ–¹æ³•ï¼Œä¸€ä¸ªä¸“é—¨æ¬ç –çš„æ–¹æ³•</span>
    <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–éœ€æ±‚æ–‡æ¡£</span>
        <span class="token keyword">const</span> prd <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prdState
        <span class="token comment">// å¼€å§‹åŸºäºéœ€æ±‚æ–‡æ¡£æä¾›çš„ä¿¡æ¯æ¬ç –ã€‚ã€‚ã€‚</span>
        <span class="token operator">...</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'996 begins...'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="é¢è¯•çœŸé¢˜-1" tabindex="-1"><a class="header-anchor" href="#é¢è¯•çœŸé¢˜-1" aria-hidden="true">#</a> é¢è¯•çœŸé¢˜</h2>
<h3 id="vue-æ•°æ®åŒå‘ç»‘å®š-å“åº”å¼ç³»ç»Ÿ-çš„å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#vue-æ•°æ®åŒå‘ç»‘å®š-å“åº”å¼ç³»ç»Ÿ-çš„å®ç°åŸç†" aria-hidden="true">#</a> Vue æ•°æ®åŒå‘ç»‘å®šï¼ˆå“åº”å¼ç³»ç»Ÿï¼‰çš„å®ç°åŸç†</h3>
<h4 id="è§£æ" tabindex="-1"><a class="header-anchor" href="#è§£æ" aria-hidden="true">#</a> è§£æ</h4>
<p>Vue æ¡†æ¶æ˜¯çƒ­é—¨çš„æ¸è¿›å¼ JavaScript æ¡†æ¶ã€‚åœ¨ Vue ä¸­ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹çŠ¶æ€æ—¶ï¼Œè§†å›¾ä¼šéšä¹‹æ›´æ–°ï¼Œè¿™å°±æ˜¯ Vue çš„æ•°æ®åŒå‘ç»‘å®šï¼ˆåˆç§°å“åº”å¼åŸç†ï¼‰ã€‚æ•°æ®åŒå‘ç»‘å®šæ˜¯ Vue æœ€ç‹¬ç‰¹çš„ç‰¹æ€§ä¹‹ä¸€ã€‚</p>
<p><img src="https://blog-picgo-typora.oss-cn-hangzhou.aliyuncs.com/image-20220805094105245.png" alt="image-20220805094105245"></p>
<p>åœ¨ Vue ä¸­ï¼Œæ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æœ‰ç›¸åº”çš„ watcher å®ä¾‹å¯¹è±¡ï¼Œå®ƒä¼šåœ¨ç»„ä»¶æ¸²æŸ“çš„è¿‡ç¨‹ä¸­æŠŠå±æ€§è®°å½•ä¸ºä¾èµ–ï¼Œä¹‹åå½“ä¾èµ–é¡¹çš„ setter è¢«è°ƒç”¨æ—¶ï¼Œä¼šé€šçŸ¥ watcher é‡æ–°è®¡ç®—ï¼Œä»è€Œè‡´ä½¿å®ƒå…³è”çš„ç»„ä»¶å¾—ä»¥æ›´æ–°â€”â€”è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚è¿™é“é¢è¯•é¢˜è€ƒå¯Ÿäº†å—è¯•è€…å¯¹ Vue åº•å±‚åŸç†çš„ç†è§£ã€å¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„å®ç°èƒ½åŠ›ä»¥åŠä¸€ç³»åˆ—é‡è¦çš„ JS çŸ¥è¯†ç‚¹ï¼Œå…·æœ‰è¾ƒå¼ºçš„ç»¼åˆæ€§å’Œä»£è¡¨æ€§ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨é¢è¯•è¿‡ç¨‹ä¸­ï¼Œé¢è¯•å®˜å¤šæ•°æƒ…å†µä¸‹ä¸ä¼šè¦æ±‚å¤§å®¶å†™å‡ºå®Œæ•´çš„å“åº”å¼åŸç†å®ç°ä»£ç ï¼Œè€Œæ˜¯è¦æ±‚ä½ â€œè¯´è¯´è‡ªå·±çš„ç†è§£â€ã€‚</p>
<p>åœ¨ Vue æ•°æ®åŒå‘ç»‘å®šçš„å®ç°é€»è¾‘é‡Œï¼Œæœ‰è¿™æ ·ä¸‰ä¸ªå…³é”®è§’è‰²ï¼š</p>
<ul>
<li>observerï¼ˆç›‘å¬å™¨ï¼‰ï¼šæ³¨æ„ï¼Œæ­¤ observer éå½¼ observerã€‚åœ¨æˆ‘ä»¬ä¸ŠèŠ‚çš„è§£æä¸­ï¼Œobserver ä½œä¸ºè®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ä¸ªè§’è‰²ï¼Œä»£è¡¨â€œè®¢é˜…è€…â€ã€‚ä½†åœ¨ Vue æ•°æ®åŒå‘ç»‘å®šçš„è§’è‰²ç»“æ„é‡Œï¼Œæ‰€è°“çš„ observer ä¸ä»…æ˜¯ä¸€ä¸ªæ•°æ®ç›‘å¬å™¨ï¼Œå®ƒè¿˜éœ€è¦å¯¹ç›‘å¬åˆ°çš„æ•°æ®è¿›è¡Œ<strong>è½¬å‘</strong>â€”â€”ä¹Ÿå°±æ˜¯è¯´å®ƒ<strong>åŒæ—¶è¿˜æ˜¯ä¸€ä¸ªå‘å¸ƒè€…</strong>ã€‚</li>
<li>watcherï¼ˆè®¢é˜…è€…ï¼‰ï¼šobserver æŠŠæ•°æ®è½¬å‘ç»™äº†<strong>çœŸæ­£çš„è®¢é˜…è€…</strong>â€”â€”watcher å¯¹è±¡ã€‚watcher æ¥æ”¶åˆ°æ–°çš„æ•°æ®åï¼Œä¼šå»æ›´æ–°è§†å›¾ã€‚</li>
<li>compileï¼ˆç¼–è¯‘å™¨ï¼‰ï¼šMVVM æ¡†æ¶ç‰¹æœ‰çš„è§’è‰²ï¼Œè´Ÿè´£å¯¹æ¯ä¸ªèŠ‚ç‚¹å…ƒç´ æŒ‡ä»¤è¿›è¡Œæ‰«æå’Œè§£æï¼ŒæŒ‡ä»¤çš„æ•°æ®åˆå§‹åŒ–ã€è®¢é˜…è€…çš„åˆ›å»ºè¿™äº›â€œæ‚æ´»â€ä¹Ÿå½’å®ƒç®¡~</li>
</ul>
<p>è¿™ä¸‰è€…çš„é…åˆè¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://blog-picgo-typora.oss-cn-hangzhou.aliyuncs.com/image-20220805094133281.png" alt="image-20220805094133281">
OKï¼Œå®ç°æ–¹æ¡ˆææ¸…æ¥šäº†ï¼Œä¸‹é¢æˆ‘ä»¬ç»™æ•´ä¸ªæµç¨‹ä¸­<strong>æ¶‰åŠåˆ°å‘å¸ƒ-è®¢é˜…è¿™ä¸€æ¨¡å¼çš„ä»£ç </strong>æ¥ä¸ªç‰¹å†™ï¼š</p>
<h3 id="æ ¸å¿ƒä»£ç " tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒä»£ç " aria-hidden="true">#</a> æ ¸å¿ƒä»£ç </h3>
<h4 id="å®ç°-observer" tabindex="-1"><a class="header-anchor" href="#å®ç°-observer" aria-hidden="true">#</a> å®ç° observer</h4>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå¯¹éœ€è¦ç›‘å¬çš„æ•°æ®å¯¹è±¡è¿›è¡Œéå†ã€ç»™å®ƒçš„å±æ€§åŠ ä¸Šå®šåˆ¶çš„ getter å’Œ setter å‡½æ•°ã€‚è¿™æ ·ä½†å‡¡è¿™ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§å‘ç”Ÿäº†æ”¹å˜ï¼Œå°±ä¼šè§¦å‘ setter å‡½æ•°ï¼Œè¿›è€Œé€šçŸ¥åˆ°è®¢é˜…è€…ã€‚è¿™ä¸ª setter å‡½æ•°ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ç›‘å¬å™¨ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// observeæ–¹æ³•éå†å¹¶åŒ…è£…å¯¹è±¡å±æ€§</span>
<span class="token keyword">function</span> <span class="token function">observe</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è‹¥targetæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™éå†å®ƒ</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> target <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// defineReactiveæ–¹æ³•ä¼šç»™ç›®æ ‡å±æ€§è£…ä¸Šâ€œç›‘å¬å™¨â€</span>
      <span class="token function">defineReactive</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®šä¹‰defineReactiveæ–¹æ³•</span>
<span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å±æ€§å€¼ä¹Ÿå¯èƒ½æ˜¯objectç±»å‹ï¼Œè¿™ç§æƒ…å†µä¸‹éœ€è¦è°ƒç”¨observeè¿›è¡Œé€’å½’éå†</span>
  <span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ä¸ºå½“å‰å±æ€§å®‰è£…ç›‘å¬å™¨</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯æšä¸¾</span>
    <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// ä¸å¯é…ç½®</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// ç›‘å¬å™¨å‡½æ•°</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>target<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">å±æ€§çš„</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">å±æ€§ä»</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">å€¼å˜æˆäº†äº†</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      val <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢å®ç°è®¢é˜…è€… Depï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// å®šä¹‰è®¢é˜…è€…ç±»Dep</span>
<span class="token keyword">class</span> <span class="token class-name">Dep</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆå§‹åŒ–è®¢é˜…é˜Ÿåˆ—</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å¢åŠ è®¢é˜…è€…</span>
  <span class="token function">addSub</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// é€šçŸ¥è®¢é˜…è€…ï¼ˆæ˜¯ä¸æ˜¯æ‰€æœ‰çš„ä»£ç éƒ½ä¼¼æ›¾ç›¸è¯†ï¼Ÿï¼‰</span>
  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      sub<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æ”¹å†™ defineReactive ä¸­çš„ setter æ–¹æ³•ï¼Œåœ¨ç›‘å¬å™¨é‡Œå»é€šçŸ¥è®¢é˜…è€…äº†ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ç›‘å¬å½“å‰å±æ€§</span>
  <span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…</span>
      dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°ä¸€ä¸ª-event-bus-event-emitter" tabindex="-1"><a class="header-anchor" href="#å®ç°ä¸€ä¸ª-event-bus-event-emitter" aria-hidden="true">#</a> å®ç°ä¸€ä¸ª Event Bus/ Event Emitter</h2>
<p>Event Busï¼ˆVueã€Flutter ç­‰å‰ç«¯æ¡†æ¶ä¸­æœ‰å‡ºé•œï¼‰å’Œ Event Emitterï¼ˆNode ä¸­æœ‰å‡ºé•œï¼‰å‡ºåœºçš„â€œå‰§ç»„â€ä¸åŒï¼Œä½†æ˜¯å®ƒä»¬éƒ½å¯¹åº”ä¸€ä¸ªå…±åŒçš„è§’è‰²â€”â€”<strong>å…¨å±€äº‹ä»¶æ€»çº¿</strong>ã€‚
å…¨å±€äº‹ä»¶æ€»çº¿ï¼Œä¸¥æ ¼æ¥è¯´ä¸èƒ½è¯´æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè€Œæ˜¯å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼ˆå…·ä½“çš„æ¦‚å¿µç”„åˆ«æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸ªå°èŠ‚ç€é‡è®²ï¼‰ã€‚å®ƒåœ¨æˆ‘ä»¬æ—¥å¸¸çš„ä¸šåŠ¡å¼€å‘ä¸­åº”ç”¨éå¸¸å¹¿ã€‚
ä¸ŠèŠ‚å¼€ç¯‡æˆ‘è¯´è¿‡ï¼Œå¦‚æœåªèƒ½è€ƒä¸€ä¸ªè®¾è®¡æ¨¡å¼çš„é¢è¯•é¢˜ï¼Œæˆ‘ä¸€å®šä¼šå‡ºè§‚å¯Ÿè€…æ¨¡å¼ã€‚
è¿™å¥è¯æ¥ç€å¾€ä¸‹è¯´ï¼Œå¦‚æœåªèƒ½é€‰ä¸€é“é¢˜ï¼Œé‚£è¿™é“é¢˜ä¸€å®šæ˜¯ Event Bus/Event Emitter çš„ä»£ç å®ç°â€”â€”æˆ‘éƒ½è¯´è¿™ä¹ˆæ¸…æ¥šäº†ï¼Œè¿™ä¸ªçŸ¥è¯†ç‚¹åˆ°åº•è¦ä¸è¦æŒæ¡ã€éœ€è¦æŒæ¡åˆ°ä»€ä¹ˆç¨‹åº¦ï¼Œå°±çœ‹å„ä½è‡ªå·±çš„äº†ã€‚</p>
<h3 id="åœ¨-vue-ä¸­ä½¿ç”¨-event-bus-æ¥å®ç°ç»„ä»¶é—´çš„é€šè®¯" tabindex="-1"><a class="header-anchor" href="#åœ¨-vue-ä¸­ä½¿ç”¨-event-bus-æ¥å®ç°ç»„ä»¶é—´çš„é€šè®¯" aria-hidden="true">#</a> åœ¨ Vue ä¸­ä½¿ç”¨ Event Bus æ¥å®ç°ç»„ä»¶é—´çš„é€šè®¯</h3>
<p>Event Bus/Event Emitter ä½œä¸ºå…¨å±€äº‹ä»¶æ€»çº¿ï¼Œå®ƒèµ·åˆ°çš„æ˜¯ä¸€ä¸ª<strong>æ²Ÿé€šæ¡¥æ¢</strong>çš„ä½œç”¨ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªäº‹ä»¶ä¸­å¿ƒï¼Œæˆ‘ä»¬æ‰€æœ‰äº‹ä»¶çš„è®¢é˜…/å‘å¸ƒéƒ½ä¸èƒ½ç”±è®¢é˜…æ–¹å’Œå‘å¸ƒæ–¹â€œç§ä¸‹æ²Ÿé€šâ€ï¼Œå¿…é¡»è¦å§”æ‰˜è¿™ä¸ªäº‹ä»¶ä¸­å¿ƒå¸®æˆ‘ä»¬å®ç°ã€‚
åœ¨ Vue ä¸­ï¼Œæœ‰æ—¶å€™ A ç»„ä»¶å’Œ B ç»„ä»¶ä¸­é—´éš”äº†å¾ˆè¿œï¼Œçœ‹ä¼¼æ²¡ä»€ä¹ˆå…³ç³»ï¼Œä½†æˆ‘ä»¬å¸Œæœ›å®ƒä»¬ä¹‹é—´èƒ½å¤Ÿé€šä¿¡ã€‚è¿™ç§æƒ…å†µä¸‹é™¤äº†æ±‚åŠ©äº Vuex ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ Event Bus æ¥å®ç°æˆ‘ä»¬çš„éœ€æ±‚ã€‚
åˆ›å»ºä¸€ä¸ª Event Busï¼ˆæœ¬è´¨ä¸Šä¹Ÿæ˜¯ Vue å®ä¾‹ï¼‰å¹¶å¯¼å‡ºï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">const</span> EventBus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> EventBus<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸»æ–‡ä»¶é‡Œå¼•å…¥ EventBusï¼Œå¹¶æŒ‚è½½åˆ°å…¨å±€ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">import</span> bus <span class="token keyword">from</span> <span class="token string">"EventBusçš„æ–‡ä»¶è·¯å¾„"</span><span class="token punctuation">;</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>bus <span class="token operator">=</span> bus<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è®¢é˜…äº‹ä»¶ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// è¿™é‡ŒfuncæŒ‡someEventè¿™ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">"someEvent"</span><span class="token punctuation">,</span> func<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å‘å¸ƒï¼ˆè§¦å‘ï¼‰äº‹ä»¶ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// è¿™é‡ŒparamsæŒ‡someEventè¿™ä¸ªäº‹ä»¶è¢«è§¦å‘æ—¶å›è°ƒå‡½æ•°æ¥æ”¶çš„å…¥å‚</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">"someEvent"</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤§å®¶ä¼šå‘ç°ï¼Œæ•´ä¸ªè°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰å‡ºç°å…·ä½“çš„å‘å¸ƒè€…å’Œè®¢é˜…è€…ï¼ˆæ¯”å¦‚ä¸ŠèŠ‚çš„ PrdPublisher å’Œ DeveloperObserverï¼‰ï¼Œå…¨ç¨‹åªæœ‰ bus è¿™ä¸ªä¸œè¥¿ä¸€ä¸ªäººåœ¨ç–¯ç‹‚åˆ·å­˜åœ¨æ„Ÿã€‚è¿™å°±æ˜¯å…¨å±€äº‹ä»¶æ€»çº¿çš„ç‰¹ç‚¹â€”â€”æ‰€æœ‰äº‹ä»¶çš„å‘å¸ƒ/è®¢é˜…æ“ä½œï¼Œå¿…é¡»ç»ç”±äº‹ä»¶ä¸­å¿ƒï¼Œç¦æ­¢ä¸€åˆ‡â€œç§ä¸‹äº¤æ˜“â€ï¼
ä¸‹é¢ï¼Œæˆ‘ä»¬å°±ä¸€èµ·æ¥å®ç°ä¸€ä¸ª Event Busï¼ˆæ³¨æ„çœ‹æ³¨é‡Šé‡Œçš„è§£æï¼‰ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handlersæ˜¯ä¸€ä¸ªmapï¼Œç”¨äºå­˜å‚¨äº‹ä»¶ä¸å›è°ƒä¹‹é—´çš„å¯¹åº”å…³ç³»</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>handlers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// onæ–¹æ³•ç”¨äºå®‰è£…äº‹ä»¶ç›‘å¬å™¨ï¼Œå®ƒæ¥å—ç›®æ ‡äº‹ä»¶åå’Œå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°</span>
  <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">eventName<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å…ˆæ£€æŸ¥ä¸€ä¸‹ç›®æ ‡äº‹ä»¶åæœ‰æ²¡æœ‰å¯¹åº”çš„ç›‘å¬å‡½æ•°é˜Ÿåˆ—</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆé¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªç›‘å¬å‡½æ•°é˜Ÿåˆ—</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æŠŠå›è°ƒå‡½æ•°æ¨å…¥ç›®æ ‡äº‹ä»¶çš„ç›‘å¬å‡½æ•°é˜Ÿåˆ—é‡Œå»</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// emitæ–¹æ³•ç”¨äºè§¦å‘ç›®æ ‡äº‹ä»¶ï¼Œå®ƒæ¥å—äº‹ä»¶åå’Œç›‘å¬å‡½æ•°å…¥å‚ä½œä¸ºå‚æ•°</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">eventName<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ£€æŸ¥ç›®æ ‡äº‹ä»¶æ˜¯å¦æœ‰ç›‘å¬å‡½æ•°é˜Ÿåˆ—</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è¿™é‡Œéœ€è¦å¯¹ this.handlers[eventName] åšä¸€æ¬¡æµ…æ‹·è´ï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†é¿å…é€šè¿‡ once å®‰è£…çš„ç›‘å¬å™¨åœ¨ç§»é™¤çš„è¿‡ç¨‹ä¸­å‡ºç°é¡ºåºé—®é¢˜</span>
      <span class="token keyword">const</span> handlers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å¦‚æœæœ‰ï¼Œåˆ™é€ä¸ªè°ƒç”¨é˜Ÿåˆ—é‡Œçš„å›è°ƒå‡½æ•°</span>
      handlers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ç§»é™¤æŸä¸ªäº‹ä»¶å›è°ƒé˜Ÿåˆ—é‡Œçš„æŒ‡å®šå›è°ƒå‡½æ•°</span>
  <span class="token function">off</span><span class="token punctuation">(</span><span class="token parameter">eventName<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> callbacks <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> index <span class="token operator">=</span> callbacks<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      callbacks<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ä¸ºäº‹ä»¶æ³¨å†Œå•æ¬¡ç›‘å¬å™¨</span>
  <span class="token function">once</span><span class="token punctuation">(</span><span class="token parameter">eventName<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯¹å›è°ƒå‡½æ•°è¿›è¡ŒåŒ…è£…ï¼Œä½¿å…¶æ‰§è¡Œå®Œæ¯•è‡ªåŠ¨è¢«ç§»é™¤</span>
    <span class="token keyword">const</span> <span class="token function-variable function">wrapper</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">cb</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span>eventName<span class="token punctuation">,</span> wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>eventName<span class="token punctuation">,</span> wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œå¤§å®¶ç”¨åˆ° EventBus/EventEmitter å¾€å¾€æä¾›æ¯”è¿™äº”ä¸ªæ–¹æ³•å¤šçš„å¤šçš„å¤šçš„æ–¹æ³•ã€‚ä½†åœ¨é¢è¯•è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå¤§å®¶èƒ½å¤Ÿå®Œæ•´åœ°å®ç°å‡ºè¿™äº”ä¸ªæ–¹æ³•ï¼Œå·²ç»éå¸¸å¯ä»¥è¯´æ˜é—®é¢˜äº†ï¼Œå› æ­¤æ¥¼ä¸Šè¿™ä¸ª EventBus å¸Œæœ›å¤§å®¶å¯ä»¥ç†Ÿç»ƒæŒæ¡ã€‚</p>
<h2 id="è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>åœ¨é¢è¯•è¿‡ç¨‹ä¸­ï¼Œä¸€äº›å¯¹ç»†èŠ‚æ¯”è¾ƒåœ¨æ„çš„é¢è¯•å®˜å¯èƒ½ä¼šè¿½é—®è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åŒºåˆ«ã€‚è¿™ä¸ªé—®é¢˜å¯èƒ½ä¼šå¼•å‘ä¸€äº›åŒå­¦çš„ä¸é€‚ï¼Œå› ä¸ºåœ¨å¤§é‡å‚è€ƒèµ„æ–™ä»¥åŠå·²å‡ºç‰ˆçš„çº¸è´¨ä¹¦ç±ä¸­ï¼Œéƒ½ä¼šå‘Šè¯‰å¤§å®¶â€œå‘å¸ƒ-è®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼æ˜¯åŒä¸€ä¸ªä¸œè¥¿çš„ä¸¤ä¸ªåå­—â€ã€‚æœ¬ä¹¦åœ¨å‰æ–‡çš„å™è¿°ä¸­ï¼Œä¹Ÿæ²¡æœ‰çªå‡ºå¼ºè°ƒä¸¤è€…çš„åŒºåˆ«ã€‚å…¶å®è¿™ä¸¤ä¸ªæ¨¡å¼ï¼Œè¦è¾ƒèµ·çœŸæ¥ï¼Œç¡®å®ä¸èƒ½ç»™å®ƒä»¬åˆ’ä¸¥æ ¼çš„ç­‰å·ã€‚
ä¸ºä»€ä¹ˆå¤§å®¶éƒ½å–œæ¬¢ç»™å®ƒä»¬å¼ºè¡Œåˆ’ç­‰å·å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºå°±ç®—åˆ’äº†ç­‰å·ï¼Œä¹Ÿä¸å½±å“æˆ‘ä»¬æ­£å¸¸ä½¿ç”¨ï¼Œæ¯•ç«Ÿä¸¤è€…åœ¨æ ¸å¿ƒæ€æƒ³ã€è¿ä½œæœºåˆ¶ä¸Šæ²¡æœ‰æœ¬è´¨çš„å·®åˆ«ã€‚ä½†è€ƒè™‘åˆ°è¿™ä¸ªé—®é¢˜ç¡®å®å¯ä»¥æˆä¸ºé¢è¯•é¢˜çš„ä¸€ä¸ªæ–¹å‘ï¼Œæ­¤å¤„æˆ‘ä»¬è¿˜æ˜¯å•ç‹¬æ‹¿å‡ºæ¥è®²ä¸€ä¸‹ã€‚
å›åˆ°æˆ‘ä»¬ä¸Šæ–‡çš„ä¾‹å­é‡Œã€‚éŸ©æ¢…æ¢…æŠŠæ‰€æœ‰çš„å¼€å‘è€…æ‹‰äº†ä¸€ä¸ªç¾¤ï¼Œç›´æ¥æŠŠéœ€æ±‚æ–‡æ¡£ä¸¢ç»™æ¯ä¸€ä½ç¾¤æˆå‘˜ï¼Œè¿™ç§<strong>å‘å¸ƒè€…ç›´æ¥è§¦åŠåˆ°è®¢é˜…è€…</strong>çš„æ“ä½œï¼Œå«è§‚å¯Ÿè€…æ¨¡å¼ã€‚ä½†å¦‚æœéŸ©æ¢…æ¢…æ²¡æœ‰æ‹‰ç¾¤ï¼Œè€Œæ˜¯æŠŠéœ€æ±‚æ–‡æ¡£ä¸Šä¼ åˆ°äº†å…¬å¸ç»Ÿä¸€çš„éœ€æ±‚å¹³å°ä¸Šï¼Œéœ€æ±‚å¹³å°æ„ŸçŸ¥åˆ°æ–‡ä»¶çš„å˜åŒ–ã€è‡ªåŠ¨é€šçŸ¥äº†æ¯ä¸€ä½è®¢é˜…äº†è¯¥æ–‡ä»¶çš„å¼€å‘è€…ï¼Œè¿™ç§<strong>å‘å¸ƒè€…ä¸ç›´æ¥è§¦åŠåˆ°è®¢é˜…è€…ã€è€Œæ˜¯ç”±ç»Ÿä¸€çš„ç¬¬ä¸‰æ–¹æ¥å®Œæˆå®é™…çš„é€šä¿¡çš„æ“ä½œï¼Œå«åšå‘å¸ƒ-è®¢é˜…æ¨¡å¼</strong>ã€‚
ç›¸ä¿¡å¤§å®¶ä¹Ÿå·²ç»çœ‹å‡ºæ¥äº†ï¼Œè§‚å¯Ÿè€…æ¨¡å¼å’Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼ä¹‹é—´çš„åŒºåˆ«ï¼Œåœ¨äºæ˜¯å¦å­˜åœ¨ç¬¬ä¸‰æ–¹ã€å‘å¸ƒè€…èƒ½å¦ç›´æ¥æ„ŸçŸ¥è®¢é˜…è€…ï¼ˆå¦‚å›¾æ‰€ç¤ºï¼‰ã€‚</p>
<p><img src="https://blog-picgo-typora.oss-cn-hangzhou.aliyuncs.com/image-20220805094256032.png" alt="image-20220805094256032"></p>
<p>åœ¨æˆ‘ä»¬è§è¿‡çš„è¿™äº›ä¾‹å­é‡Œï¼ŒéŸ©æ¢…æ¢…æ‹‰é’‰é’‰ç¾¤çš„æ“ä½œï¼Œå°±æ˜¯å…¸å‹çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼›è€Œé€šè¿‡ EventBus å»å®ç°äº‹ä»¶ç›‘å¬/å‘å¸ƒï¼Œåˆ™å±äºå‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€‚
æ—¢ç”Ÿç‘œï¼Œä½•ç”Ÿäº®ï¼Ÿæ—¢ç„¶æœ‰äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦å‘å¸ƒ-è®¢é˜…æ¨¡å¼å‘¢ï¼Ÿ
å¤§å®¶æ€è€ƒä¸€ä¸‹ï¼šä¸ºä»€ä¹ˆè¦æœ‰è§‚å¯Ÿè€…æ¨¡å¼ï¼Ÿè§‚å¯Ÿè€…æ¨¡å¼ï¼Œè§£å†³çš„å…¶å®æ˜¯æ¨¡å—é—´çš„è€¦åˆé—®é¢˜ï¼Œæœ‰å®ƒåœ¨ï¼Œå³ä¾¿æ˜¯ä¸¤ä¸ªåˆ†ç¦»çš„ã€æ¯«ä¸ç›¸å…³çš„æ¨¡å—ï¼Œä¹Ÿå¯ä»¥å®ç°æ•°æ®é€šä¿¡ã€‚ä½†è§‚å¯Ÿè€…æ¨¡å¼ä»…ä»…æ˜¯å‡å°‘äº†è€¦åˆï¼Œ<strong>å¹¶æ²¡æœ‰å®Œå…¨åœ°è§£å†³è€¦åˆé—®é¢˜</strong>â€”â€”è¢«è§‚å¯Ÿè€…å¿…é¡»å»ç»´æŠ¤ä¸€å¥—è§‚å¯Ÿè€…çš„é›†åˆï¼Œè¿™äº›è§‚å¯Ÿè€…å¿…é¡»å®ç°ç»Ÿä¸€çš„æ–¹æ³•ä¾›è¢«è§‚å¯Ÿè€…è°ƒç”¨ï¼Œä¸¤è€…ä¹‹é—´è¿˜æ˜¯æœ‰ç€è¯´ä¸æ¸…ã€é“ä¸æ˜çš„å…³ç³»ã€‚
è€Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œåˆ™æ˜¯å¿«åˆ€æ–©ä¹±éº»äº†â€”â€”å‘å¸ƒè€…å®Œå…¨ä¸ç”¨æ„ŸçŸ¥è®¢é˜…è€…ï¼Œä¸ç”¨å…³å¿ƒå®ƒæ€ä¹ˆå®ç°å›è°ƒæ–¹æ³•ï¼Œäº‹ä»¶çš„æ³¨å†Œå’Œè§¦å‘éƒ½å‘ç”Ÿåœ¨ç‹¬ç«‹äºåŒæ–¹çš„ç¬¬ä¸‰æ–¹å¹³å°ï¼ˆäº‹ä»¶æ€»çº¿)ä¸Šã€‚å‘å¸ƒ-è®¢é˜…æ¨¡å¼ä¸‹ï¼Œå®ç°äº†å®Œå…¨åœ°è§£è€¦ã€‚
ä½†è¿™å¹¶ä¸æ„å‘³ç€ï¼Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼å°±æ¯”è§‚å¯Ÿè€…æ¨¡å¼â€œé«˜çº§â€ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬çš„æ¨¡å—è§£è€¦è¯‰æ±‚<strong>å¹¶éæ€»æ˜¯éœ€è¦å®ƒä»¬å®Œå…¨è§£è€¦</strong>ã€‚å¦‚æœä¸¤ä¸ªæ¨¡å—ä¹‹é—´æœ¬èº«å­˜åœ¨å…³è”ï¼Œä¸”è¿™ç§å…³è”æ˜¯ç¨³å®šçš„ã€å¿…è¦çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼å°±è¶³å¤Ÿäº†ã€‚è€Œåœ¨æ¨¡å—ä¸æ¨¡å—ä¹‹é—´ç‹¬ç«‹æ€§è¾ƒå¼ºã€ä¸”æ²¡æœ‰å¿…è¦å•çº¯ä¸ºäº†æ•°æ®é€šä¿¡è€Œå¼ºè¡Œä¸ºä¸¤è€…åˆ¶é€ ä¾èµ–çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šå€¾å‘äºä½¿ç”¨å‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€‚</p>
<h1 id="è¿­ä»£å™¨æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#è¿­ä»£å™¨æ¨¡å¼" aria-hidden="true">#</a> è¿­ä»£å™¨æ¨¡å¼</h1>
<h2 id="å®ç°ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#å®ç°ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°" aria-hidden="true">#</a> å®ç°ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°</h2>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// ç¼–å†™ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">iteratorGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token string">"1å·é€‰æ‰‹"</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token string">"2å·é€‰æ‰‹"</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token string">"3å·é€‰æ‰‹"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> iterator <span class="token operator">=</span> <span class="token function">iteratorGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†™ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°å¹¶æ²¡æœ‰ä»€ä¹ˆéš¾åº¦ï¼Œä½†åœ¨é¢è¯•çš„è¿‡ç¨‹ä¸­ï¼Œé¢è¯•å®˜å¾€å¾€å¯¹ç”Ÿæˆå™¨è¿™ç§è¯­æ³•ç³–èƒŒåçš„å®ç°é€»è¾‘æ›´æ„Ÿå…´è¶£ã€‚ä¸‹é¢æˆ‘ä»¬è¦åšçš„ï¼Œä¸ä»…ä»…æ˜¯å†™ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œè€Œæ˜¯ç”¨ ES5 å»å†™ä¸€ä¸ªèƒ½å¤Ÿç”Ÿæˆè¿­ä»£å™¨å¯¹è±¡çš„è¿­ä»£å™¨ç”Ÿæˆå‡½æ•°ï¼ˆè§£æåœ¨æ³¨é‡Šé‡Œï¼‰ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="language-javascript"><code><span class="token comment">// å®šä¹‰ç”Ÿæˆå™¨å‡½æ•°ï¼Œå…¥å‚æ˜¯ä»»æ„é›†åˆ</span>
<span class="token keyword">function</span> <span class="token function">iteratorGenerator</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// idxè®°å½•å½“å‰è®¿é—®çš„ç´¢å¼•</span>
  <span class="token keyword">var</span> idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// lenè®°å½•ä¼ å…¥é›†åˆçš„é•¿åº¦</span>
  <span class="token keyword">var</span> len <span class="token operator">=</span> list<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// è‡ªå®šä¹‰nextæ–¹æ³•</span>
    <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœç´¢å¼•è¿˜æ²¡æœ‰è¶…å‡ºé›†åˆé•¿åº¦ï¼Œdoneä¸ºfalse</span>
      <span class="token keyword">var</span> done <span class="token operator">=</span> idx <span class="token operator">>=</span> len<span class="token punctuation">;</span>
      <span class="token comment">// å¦‚æœdoneä¸ºfalseï¼Œåˆ™å¯ä»¥ç»§ç»­å–å€¼</span>
      <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token operator">!</span>done <span class="token operator">?</span> list<span class="token punctuation">[</span>idx<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>

      <span class="token comment">// å°†å½“å‰å€¼ä¸éå†æ˜¯å¦å®Œæ¯•ï¼ˆdoneï¼‰è¿”å›</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">done</span><span class="token operator">:</span> done<span class="token punctuation">,</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> value<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> iterator <span class="token operator">=</span> <span class="token function">iteratorGenerator</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"1å·é€‰æ‰‹"</span><span class="token punctuation">,</span> <span class="token string">"2å·é€‰æ‰‹"</span><span class="token punctuation">,</span> <span class="token string">"3å·é€‰æ‰‹"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></template>


